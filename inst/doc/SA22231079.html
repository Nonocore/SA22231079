<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA22231079" />


<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">SA22231079</h4>
<h4 class="date">2023.12.05</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>The answers of the homework in this term.</p>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
<div id="ex-1" class="section level3">
<h3>Ex 1</h3>
<p>Use the inverse transform to replicate part of sample (replace=TRUE)
in a function named my.sample.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>mysample <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">str=</span><span class="dv">1</span>,<span class="at">stp=</span><span class="dv">100</span>, <span class="at">num =</span> <span class="dv">20</span>){ <span class="co">#默认从1到100中有放回地随机挑选20个变量</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  n <span class="ot">=</span> stp <span class="sc">-</span> str <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">seq</span>(str, stp, <span class="dv">1</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n, n)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  Fu <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">cumsum</span>(p));  <span class="co">#累加得到分布函数</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">integer</span>(num)  </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  m <span class="ot">=</span> <span class="fu">length</span>(Fu)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(num)  </span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m<span class="dv">-1</span>){   <span class="co">#逆转函数</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    index <span class="ot">=</span> u<span class="sc">&gt;</span>Fu[i] <span class="sc">&amp;</span> u<span class="sc">&lt;=</span>Fu[i<span class="sc">+</span><span class="dv">1</span>]; </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    y[index]<span class="ot">=</span>x[i];</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  };</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  y</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section" class="section level3">
<h3>3.2</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>U <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">integer</span>(<span class="dv">1000</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){      <span class="co">#reverse func</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="cf">if</span>(U[i] <span class="sc">&gt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    x[i] <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>U[i]) </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    }</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(U[i] <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    x[i] <span class="ot">=</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>U[i])</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>      }</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="cf">else</span> U[i] <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>}</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>))  <span class="co"># Plot the frequency histogram for generating a random number x</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>xx <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="fl">0.1</span>)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">lines</span>(xx ,<span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(xx))) <span class="co">#Curve Fitting Controls</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level3">
<h3>3.7</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>myB <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">a=</span><span class="dv">3</span>,<span class="at">b=</span><span class="dv">2</span>){      <span class="co">#Default generation of 1000 random variables conforming to B(3, 2) distribution</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  F <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x<span class="sc">^</span>(a<span class="dv">-1</span>))<span class="sc">*</span>((<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  Be <span class="ot">=</span> <span class="fu">integrate</span>(F,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">0</span> </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">integer</span>(n)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="cf">while</span>(i<span class="sc">&lt;</span>n)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  {</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">F</span>(y) <span class="sc">&gt;</span> u){                     <span class="co">#A-C</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>      i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>      x[i] <span class="ot">=</span> y</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    }</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  }</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  x</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>}</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">myB</span>()</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="fu">hist</span>(B,<span class="at">prob=</span>T)  </span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>xx <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="fu">lines</span>(xx,<span class="fu">dbeta</span>(xx,<span class="dv">3</span>,<span class="dv">2</span>)) <span class="co"># Curve Fitting Controls</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v////NBSitAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJZUlEQVR4nO2d7WKbNhhGlS5ZsnQfydKtSfcZui0rbbq4iX3/lzYkAQYZeJD0YoT9nB8tYCRLJ0JIQhZqQwZRcycgdSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAxILWd+rsyf5/Xu80Pv7rX+kvfH+h1PdmM1eWk+8eIiKcVdDzzStpQSut5MpsVoKUivmWfQraIYtKeie5OrmvN2uuwiOcoQR9vCyLfVb9dR/fKPXVT6Zwrd8rdXpvzBV5/f1GvXrYPN4U570u8v1yrc4fL9XJ283Hi+Ks7dfUEZgoS0V5qf/LRdcfZyz7F5TXxb4SVB7RJxan6Bxebg+fPa3KquReC7Jcti+cbQRdgh4v0i5BFaUgXQqeNp9MsbeXWPEXtt6uTBVy/rTOKm9nD5v/ilBfP+mTroygKx1WvS3PNzQj6LzEnFuDF3sXVOTm9J/yUyuorIkyW6j0diHCCrotT/z896WOoDhe5NX++2VbLpoRdAkqLslw9i7IHrE1jslSdRXqrFXbrbyuf6ki0KVvU/67FdSM4BAq6ecb+2f9s/Rg82uurttquylIGz397fN1r6BmBG1Btg56vo65Wc7RDnr+9bKqUkeUIGvipV9QfwkqvTSO+TNTQ3H9blvj9NdBJl+mYNSVdIeg/jqoLEF3ixJU5PcHc52ZG49Oef9drCpBZ09FJntLEL6LxdzG9l+C3tfNGtMvGGoH1XXQYCXdbAd1C4ooQHNcYp90DfRadyBNs/mhbAj/bAMUh7592LmLnf6hL5g+QY0IugS9TrizGkgW1bYTJTFBmRmriOs9yZKYoJVArSFLYoI2z28uYoe4ZElNUHJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCLBAQcpl2m+bNPZJUB/aUJADBQEoCFALMhUQBe3Wyls3dmvaL580dhmca6p209if8Muni1oMV1BHHTSdosUJcopPXUlPlZGlCVLdJWgzWSFaliBbQffc5imoVNPbDpokL0sSpPor6fLECXKzIEGOpw5BU2RnMYKUc6E1BE3au1+KoIaVHUHOzlEKUn1CdvbVUQpS4wV9OMZLzC0jg4KOsgQtXtC048O+gkQTIZyjKQS5vVNcgiRTkb4g5X+JHZUgFVIHCSYjdUFmNIyChuMLuIvJpaOOqVroSig6GcrBQn9BcglpRJTHrYbmRidANVaYiKCNgCORdO10zwMEiRly48lV1NqwMoKcnKcjSC9Oc7tZ34WvbiQpqG8AaGRXQ8jQNhq9Dqg1swovQoKCVJ+BmQS9XEssaiQnqH+EbGxnVaibWW28/Gj9RBSfzVEIytMQNDBCNnq4QyYx9r9se09N4Da/O848u6BtCRKKLiqSnWHmMEEiqUmxL7ZgQdWyob31lFBLetCAx5CrQHJsFC/XV/V68QOVdF5VUKu+mkq0JR0qSPQ5ok/w9d12edmexrZIoY4V1N7eo6CX62qN+d7WkkiZTlRQcZmZFxH098P2U4KSFZTpNxacb7KBYbO8ek3BhHXQ7hh0jKD4J9GNvthtke/b4a5GVZP3FrMDF5TpZa7n7Wp0DNJHCYp+jNi4xM5frvWLU6JGpmMFdQ3SpyKouHz0exvG+ekrZyKpSVRQVCyirTJRQftsB00eXfdTjFQEwX6WX3QRgRMVlEm8LS4mNdtxHFlBIqXaNqTjOWhBt0Pn2VO2lbH8XawxjCMrSOa634y5wa/v0GV4wIJMPwMBLYanpTnMlaSgMQNm2GJwWpoB0xQkQ5KCZG4dMoRG1wqXqiDz9sks7mYfmJR2sEQFrU7uc92bn+HBoRNKviUtcXPV46l6IHWG8SA3UJqCdENRC5ph8sL0giSaH1UJyqLeDTcuITtz7Aan3CUiqKyD8hHNxVHRDZ7VzoFvjmcSZJuKkbOoAgS5T+InESTTQBPAX5Dyz/FRCVIBOQ4RFN+EtX2x2Ld3Hq6gzFbOeeRce19BKiTHcwhaVZXzl4t93sVUUI5nENQY5xl6Nj82OnhWOyt7ERTXTWz0wPbR1ViiIDjzxyc6eFY7JxS0c1Y7IxS0c1Y7H/sRFDUUEyvI89m80/hZhCD4xMsnOnhWOxcLECRGyoJkBqsiGStIDeRIWlDcvOl5BKmhHEkLcrYWIUgoxxR0LILAoPO+BJVjBxI5CqZHkJNiCnKPOgmmIPdoM70U1HHUTeNMgsx22oIUygIFUVDXUSexswkydwiJHAUzKKhu/1CQe9RJ6eEKCvxZuHvrOlhBoT8LN3XjEQgK/lGv2zacT9AH759o+pwe/LNwt3t6qIJiStBRCAr9Wbj0nLp0BYX9LFx80mHU6amNSZtBcgrqi65MzREKGv5Z+MTzeiNP34sgN5b2Qyc0D3pe5hB0wFAQQLizengId1YPD+GuRhlp0kwnaPQ0KxQp+Dzu49jgEaePL0FxX7pYQSM6q+MiPVhBuLM6LtLDFSQUKQXFfU5BFBT3OQUdvaBDgoIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEkBa2aC1itvFezckN4rqbWCq5f9hm1SkuNoCC9gky9ikxrxz+43vdbzKgVPNc7MobkBNmHQuXiMa0d/+Cbcl3Q4G8/9/z2fuQE2ZWHyolDrR3/4Hrr7J2PoFbwRAV9o8t3+ci1teMf3Ox61UHt4EleYrYCKKuB1o5/cHPFeAlyvtD/FtFHooK81wRtB9dvePhyITIDJc1LzOyEX2L+NWA/aVbSeTlTZXwt0gruX377SfY271mCWsGtrbiloirSbSh6tqRbwZOsg8yFoVNoWyG5932kFXzj3dVoBdevZpaZJcjOKoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQESFxQZmbBCE0WCyJ1QWYCQz6joUUIaryCce8sRJDMrPkQFiEoF5nxHEbqgkYtxzMlqQsyalZqviK0CEFmzuFMLEOQzJTnIJYhyHM+pySLECT0u5QgUhfErkbqUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgP8BDnF0XvcrsZ8AAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-2" class="section level3">
<h3>3.9</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fl">0.75</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)   <span class="co">#topic-specific recapitulation</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">integer</span>(n)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  u3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u2[i]) <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u1[i]),u[i] <span class="ot">&lt;-</span> u2[i],</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>         u[i] <span class="ot">&lt;-</span> u3[i])</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>}</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">hist</span>(u, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">F</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v////+30rdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ00lEQVR4nO2da3vbJhiGyZos2bKuW7J0W5Odq+6Q2T0sTmL//x82AZIsYaMHBEjIfu4PraPDa7gvhMRBWGxIL2LqBOQOBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBEgtaH0nzh70/+fNH63df/4b+wvfXQjxTbx40wp6uvkstqCVKLmKF29UQTsUIrqgpTh5GzPeFCXo/aUQJ6/upZ8SqejjayFefK8K1/qdEKdvlbkyr7/diM/uNx9vyuNelvl+vhbnHy/FyZvN+4vyqO3XNAFUyEqR1l+eE1KgJhC0FKISUwuqtsgDy0NkDi+3m88eVnp3me0ys5rLWq1mG2COgmoqQbIUPGw+qIpCZ+HxovJ2paqQ84d1UXs7u9/8V571+YM86EoJupLnijfV8Yp2gNYlNlNBZW5O/6n26ixUNVGhC1WVKS3otjrw01+XMkC5vTSh/1XG2mE29XU5c0F6i65xVBbqq1Bmrf7cyev65zqALH2b6t+toHaAOQoy66CnG12l/FFlQedXXV239ee2IGn09NdP11ZB7QC7glolbQiTPAc9/XJZV6kOJUjn8NkuqL8EzVGQ/PunbY1jr4NUXlXBaCrpPYJsdZD+uAp7bhxfUJngb9V1pm48Mgv2u1hdgs4enu7sdZDtLqY2yBPnJWjzrnmsUe2Cvuegpg7qraTbz0FtQeURmpkJ2nyQNdDL+0312HxfPQj/oE8oN319v3MXO/19WW6yCWoFaDc1Hsvbwau/876LDaQwm/2TkZugQvVVlKVjT9N2EnITVLW7IjfJA8hN0Obp9UXV1s+D7ATlBgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH8BBVCnKthqlt87IHgJWiphtPVyFTEWYB54yNofSfHhtV4wzKXYavk+Ah6vi6vrJWaJ7CKPvkyV1iCAMPqIKXqOOBdDMDnIAAFAQYKWvIu5helIUq4nIicIwoaN1wG+OWonk9prYGSCBIGKb7D/uU+By/r6ZAr27zINIIWHfIV1Hp+tjU1jluQaqxqbI3V4xY0egky6p7sBZV1UFWExqiDtrVxY0Y7ylhQ80qktbMjVuI796rWJSYV5SxopHDGnbxTB2V9mx8n3I4Bs5Ie9bkoO0F78msKWohumQr+zt705BVO6dkpIqagRUfRMQnSxccQstgjqK3oiARVZzsJWhyfoJ3nnn5BTRk6fEGgzrEJai62uFkwE5dBONGtU0whdkGLEZ6scxEk7EJ6BOk7WtwsmInLIJzo3rZ9BMkTj0GQsBsAghZHIajXABC0OIKmBhACBCU2lIEgdFuHgpKOpUwvSASXoMMWJMIvsaTDcVMPPavWe7CghIYmKUF+TQsXQekMNYHrda4ihes/qpvZeQjSi/CEzqzzFCRchDgJSmaoGzfYkZ8gs2cnRFAqQ2bYZd/UBP9wlqNSCEpkqBN1paZnru+Gz/H1EiRsOfYUlHSUYxtNDgpqMwGzxH0ECWuOPQUZHxIJer6OsaaRhyDnDjJnQUl6GLeCvtN+wl4ycBdk9gvGEJSih3FHUNj81YkFJehhrKIV2ypunNu8Rw+ijyD5R+ISFClc/1E7mZqBoDHDGa2vmIKid8EenKDYHYw62vP1VbNc/EiV9LwE+fF4YX0bKgNBE15iTSGzlzOncJ6jGLkIkm8yL3umH26auZuBJWinEzq2oKiGtsEK+YMF55uir9vs+Vr6CxO02wkdvQTFNNRqi92WJeQWNTWKssV2vIIKuco1uIstxVX2gqJO124+FefyAnq+Rj3TjxcvQgTtGcaIXgfF7B7q9AfJn23APffrO/tLzzA1+yYhxhbU3RZNUBRQuKqDPbmgdidR2hxZsNVUhywIvk3YF8X1gh9NUKsj1j87uymWFDHe9AapqUdoRhDUbI4lKM6SQP2paQZo5inIYT2OwJd6Zy3I5QYf+FJvs3MUQY0oJw840aqd0U/gK5nbfeMIqmtrJw841Q4dZoEv9c5ckAODS5DD+00pBFVPRF4+HHNkYehLvcaj2/Ac+x4uogpSPz5Z9N7sB77Ua7SOZipodfJ2KVvzCQYOD0KQrGBkzZJi6FkYuRhNkPwc80FRCkoxeQG8jDEPQXUJKoJWSMxN0CJ4oNWsg5ZhKwBmJyh4jKN7Fwv+ZTjbc1DEHE8nKAYUNChc1BxPJUg/A4auYZufoFiVdKEr52XgXPu9qXF/zzuJoDBD1dmrunLuGRT0CGdsnL+gVm9Z79i8Yzhz48SXWJChZgJVvSF+UwO+Upi8DgoxVAuCXWE+4cxNFGSEMzdRkBHO3EJBRjhzy9SCQgzVguDsw/4o1qHnfbM5JnhQHG4odVODgkC4TAQNz2diQXtnc1CQ+XcGggZnNK2g/dNdKMj8k4Is4SzTXabpDxqYUwryylEwGQsamNWUgrZJm1RQ2MTyIxBkfMpH0PYzBe0NR0HWcGBGGQUJI52ZCNIfkwpynCctjGQejSDXedK5ClKfEwpynuV6rIKc50lnK0j+kUkJMpN1FIKc50nnK2jhPSXP73DHedJBK2jPWpBjOApCgvyyNKYg79kwAwX1v9Q7ao7zFGRG6Xa27LTFsmIKQQcMBQEiN1YPj8iN1cMjclOjCpo16QQ5T7NyDep43CSHDTncvQTF/fLZCHJorPoFPThBuLHqF/TwBEUOSkFxjqOgHA8beHjcoBQU57jDE3RIUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIEBsQY9fNsMdq8D1rDrn24O19+guYcvqI8OSFlnQ83UzHiQXlFkFGOqcbw/W2fP4hf37BiYtrqDVdlRajxENX0umc749WHdPz3Dd0KRFFbQSV00S9UJEw9eS6ZxvD9bds7RmenDSYtdB21So0j58oYvO+fZg3T3FV8L+I43DkpZMkL7Gh1dCnfPtwTp79G8z2dbrHZa0gxJkJCFK0g7rEtObLMuwTXqJNb/DPm0lrTdZ7vWZVdJT3OZ1zuElNt1tvp2KSR4UVaZhJT3hg2KVCr3q4DKwqVGdj4J1DpM/yWxbCHJY0thYBVAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAXIXpNYsai1cNDoUBKAgAAUBKAhAQYD8BV0F/0J3ELkLWt+dPazvrDNX05O7IPUS4Y+8xPKFggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A+e6OBkIpXuUwAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<div id="ex-1-1" class="section level3">
<h3>Ex 1</h3>
<p>Proof that what value <span class="math inline">\(\rho=l/d\)</span>
should take to minimize the asymptotic variance of <span class="math inline">\(\hat \pi\)</span> (m~B(n,p),using <span class="math inline">\(\delta\)</span> method)</p>
<p><span class="math inline">\(we can see that \hat{\pi} =
\frac{2l}{d\hat{p}}，through \delta method we can get that：\)</span>
<span class="math display">\[
Var(\hat\pi) = Var(\frac{2l}{d\hat{p}}) \approx
(\frac{d\hat{\pi}}{d\hat{p}})Var(\hat{p})=(-\frac{2l}{d{\hat{p}}^2})Var(\hat{p})
\]</span> <span class="math display">\[
Var(\hat{p}) = Var(\frac{n}{m}) \approx
(\frac{d\hat{p}}{dm})Var(m)=(-\frac{n}{m^2})Var(m)=-\frac{n^2p(1-p)}{m^2}
\]</span> So: <span class="math display">\[
Var(\hat\pi) =(-\frac{2l}{d{\hat{p}}^2})(-\frac{n^2p(1-p)}{m^2})
\]</span></p>
</div>
<div id="ex-2" class="section level3">
<h3>Ex 2</h3>
<p>Take three different values of <span class="math inline">\(\rho\)</span> (<span class="math inline">\(0 \leq
\rho \leq 1\)</span>, including <span class="math inline">\(\rho_{min}\)</span>) and use Monte Carlo
simulation to verify your answer. (n = <span class="math inline">\(10^6\)</span>, Number of repeated simulations K =
100)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1E6</span>  </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span>  </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>rho_1 <span class="ot">&lt;-</span> <span class="fl">1.0</span>  <span class="co"># ρmin</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>rho_2 <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># ρ2</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>rho_3 <span class="ot">&lt;-</span> <span class="fl">0.8</span>  <span class="co"># ρ3</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co"># simulate pi</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>simulate_pi <span class="ot">&lt;-</span> <span class="cf">function</span>(rho) {</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  pi_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(K)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, rho)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    <span class="co"># calcu p_hat and pi_hat</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>    p_hat <span class="ot">&lt;-</span> n <span class="sc">/</span> m</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    pi_hat <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> rho <span class="sc">*</span> p_hat</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>    pi_values[i] <span class="ot">&lt;-</span> pi_hat</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>  }</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  <span class="fu">return</span>(pi_values)</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>}</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>pi_values_1 <span class="ot">&lt;-</span> <span class="fu">simulate_pi</span>(rho_1)</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>var_pi_1 <span class="ot">&lt;-</span> <span class="fu">var</span>(pi_values_1)</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>pi_values_2 <span class="ot">&lt;-</span> <span class="fu">simulate_pi</span>(rho_2)</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>var_pi_2 <span class="ot">&lt;-</span> <span class="fu">var</span>(pi_values_2)</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>pi_values_3 <span class="ot">&lt;-</span> <span class="fu">simulate_pi</span>(rho_3)</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>var_pi_3 <span class="ot">&lt;-</span> <span class="fu">var</span>(pi_values_3)</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;ρmin：&quot;</span>, var_pi_1))</span></code></pre></div>
<pre><code>## [1] &quot;ρmin： 0&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;ρ2:&quot;</span>, var_pi_2))</span></code></pre></div>
<pre><code>## [1] &quot;ρ2: 3.4287353096141e-06&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;ρ3:&quot;</span>, var_pi_3))</span></code></pre></div>
<pre><code>## [1] &quot;ρ3: 1.23041122736954e-06&quot;</code></pre>
</div>
<div id="section-3" class="section level3">
<h3>5.6</h3>
<p>By <span class="math inline">\(U ∼ Uniform(0,1)\)</span> we can see：
<span class="math display">\[
E(e^U)=E(e^{1−U})=\int_{0}^{1} e^x dx=e-1
\]</span> <span class="math display">\[
\begin{align*}
E(e^Ue^{1−U})=&amp;\int_{0}^{1} e^x e^{1-x} dx\\
              =&amp;\int_{0}^{1} e^{1-x} de^x\\
              =e\\
\end{align*}
\]</span> <span class="math display">\[Cov(e^U, e^{1−U}) =
E(e^Ue^{1−U})-E(e^U)E(e^{1−U})\]</span> By <span class="math inline">\(Var(X)=E(X^2)-[E(X)]^2\)</span> get that : <span class="math display">\[
\begin{align*}
{Var}(e^U) &amp;= E(e^{2U}) - [E(e^U)]^2 \\
&amp;= \int_{0}^{1} e^{2x}dx - \left(\int_{0}^{1} e^{x}dx\right)^2 \\
&amp;= \frac{4e - e^2 - 3}{2} = {Var}(e^{1-U})
\end{align*}
\]</span> ### 5.7</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1E4</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>simula <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  theta1.hat <span class="ot">&lt;&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(x)) </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  theta2.hat <span class="ot">&lt;&lt;-</span> (<span class="fu">mean</span>(<span class="fu">exp</span>(x1))<span class="sc">+</span><span class="fu">mean</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x1)))<span class="sc">/</span><span class="dv">2</span> </span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  true <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">c</span>(theta1.hat,theta2.hat,true)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="fu">simula</span>()</span></code></pre></div>
<pre><code>## [1] 1.722313 1.718397 1.718282</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>V1 <span class="ot">=</span> <span class="fu">integer</span>(m)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>V2 <span class="ot">=</span> <span class="fu">integer</span>(m)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">simula</span>()</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  V1[i] <span class="ot">&lt;-</span> theta1.hat</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  V2[i] <span class="ot">&lt;-</span> theta2.hat</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>}</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">var</span>(V1)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">var</span>(V2)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>ans <span class="ot">&lt;-</span> (a<span class="sc">-</span>b)<span class="sc">/</span>a</span></code></pre></div>
<p>the answer is close to 0.9685652</p>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
<div id="section-4" class="section level3">
<h3>5.13</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(u)u<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(u)<span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>u<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="fu">f1</span>(u)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">f2</span>(u)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(T1), <span class="fu">mean</span>(T2))  </span></code></pre></div>
<pre><code>## [1] 0.8008805 0.8557608</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sd</span>(T1)<span class="sc">/</span><span class="fu">sqrt</span>(m), <span class="fu">sd</span>(T2)<span class="sc">/</span><span class="fu">sqrt</span>(m))</span></code></pre></div>
<pre><code>## [1] 0.001616692 0.001213804</code></pre>
</div>
<div id="section-5" class="section level3">
<h3>5.14</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>}</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">1.5</span>) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>}</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>rf1 <span class="ot">=</span> <span class="cf">function</span> () {</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="fu">rnorm</span>(M, <span class="at">mean =</span> <span class="fl">1.5</span>)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>}</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>is_norm <span class="ot">=</span> <span class="cf">function</span> () {</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>  xs <span class="ot">=</span> <span class="fu">rf1</span>()</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">g</span>(xs)<span class="sc">/</span><span class="fu">f1</span>(xs), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  </span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>}</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>(<span class="at">theta1 =</span> <span class="fu">is_norm</span>())</span></code></pre></div>
<pre><code>## [1] 0.5804579</code></pre>
</div>
<div id="section-6" class="section level3">
<h3>5.15</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>r <span class="ot">&lt;-</span> M<span class="sc">/</span>k </span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span> </span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(t)(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>t<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(t<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(t<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  est[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M)))</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)T2[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M<span class="sc">/</span>k,(j<span class="dv">-1</span>)<span class="sc">/</span>k,j<span class="sc">/</span>k)))</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  est[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(T2)</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>}</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="fu">apply</span>(est,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.4961881 0.4964658</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">apply</span>(est,<span class="dv">2</span>,sd)</span></code></pre></div>
<pre><code>## [1] 0.0010250732 0.0001886665</code></pre>
</div>
<div id="section-7" class="section level3">
<h3>6.5</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> USL <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="at">mean =</span> mu1,<span class="at">sd =</span><span class="dv">2</span>)</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  est[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  est[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(y))<span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  UCL[i] <span class="ot">&lt;-</span> est[i, <span class="dv">1</span>] <span class="sc">+</span> est[i, <span class="dv">2</span>]</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  USL[i] <span class="ot">&lt;-</span> est[i, <span class="dv">1</span>] <span class="sc">-</span> est[i, <span class="dv">2</span>]</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>  s1<span class="ot">&lt;-</span>s1<span class="sc">+</span>(USL[i] <span class="sc">&lt;</span> mu1 <span class="sc">&amp;&amp;</span> mu1 <span class="sc">&lt;</span> UCL[i] )</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>}</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>s1<span class="sc">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.951</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> USL <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  est[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  est[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(y))<span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> n<span class="dv">-1</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  UCL[i] <span class="ot">&lt;-</span> est[i, <span class="dv">1</span>] <span class="sc">+</span> est[i, <span class="dv">2</span>]</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>  USL[i] <span class="ot">&lt;-</span> est[i, <span class="dv">1</span>] <span class="sc">-</span> est[i, <span class="dv">2</span>]</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>  s2<span class="ot">&lt;-</span>s2<span class="sc">+</span>(USL[i] <span class="sc">&lt;</span> mu2 <span class="sc">&amp;&amp;</span> mu2 <span class="sc">&lt;</span> UCL[i] )</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>}</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>s1<span class="sc">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.951</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>s2<span class="sc">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.919</code></pre>
</div>
<div id="a" class="section level3">
<h3>6.A</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>P6A <span class="ot">&lt;-</span> <span class="cf">function</span>(seed){</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>) </span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  M<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  er<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> num){</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>    cv<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>    er1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>    er2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>    er3 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>      m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>      se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>      P<span class="ot">&lt;-</span> <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>      er1 <span class="ot">&lt;-</span> er1<span class="sc">+</span>P</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>    }</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>    er1 <span class="ot">&lt;-</span> er1<span class="sc">/</span>M</span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>    </span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a>      m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a>      se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a>      P<span class="ot">&lt;-</span> <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv</span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a>      er2 <span class="ot">&lt;-</span> er2<span class="sc">+</span>P</span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a>    }</span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a>    er2 <span class="ot">&lt;-</span> er2<span class="sc">/</span>M</span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a>    </span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb30-30"><a href="#cb30-30" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb30-31"><a href="#cb30-31" tabindex="-1"></a>      m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb30-32"><a href="#cb30-32" tabindex="-1"></a>      se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb30-33"><a href="#cb30-33" tabindex="-1"></a>      P<span class="ot">&lt;-</span> <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv</span>
<span id="cb30-34"><a href="#cb30-34" tabindex="-1"></a>      er3 <span class="ot">&lt;-</span> er3<span class="sc">+</span>P</span>
<span id="cb30-35"><a href="#cb30-35" tabindex="-1"></a>    }</span>
<span id="cb30-36"><a href="#cb30-36" tabindex="-1"></a>    er3 <span class="ot">&lt;-</span> er3<span class="sc">/</span>M</span>
<span id="cb30-37"><a href="#cb30-37" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" tabindex="-1"></a>    er<span class="ot">&lt;-</span><span class="fu">cbind</span>(er,<span class="fu">c</span>(er1,er2,er3))</span>
<span id="cb30-39"><a href="#cb30-39" tabindex="-1"></a>  }</span>
<span id="cb30-40"><a href="#cb30-40" tabindex="-1"></a>  <span class="fu">colnames</span>(er)<span class="ot">&lt;-</span>num</span>
<span id="cb30-41"><a href="#cb30-41" tabindex="-1"></a>  <span class="fu">rownames</span>(er)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;chi(1)&quot;</span>,<span class="st">&quot;U(0,2)&quot;</span>,<span class="st">&quot;exp(1)&quot;</span>)</span>
<span id="cb30-42"><a href="#cb30-42" tabindex="-1"></a>  <span class="fu">return</span>(er)                </span>
<span id="cb30-43"><a href="#cb30-43" tabindex="-1"></a>}</span>
<span id="cb30-44"><a href="#cb30-44" tabindex="-1"></a><span class="fu">P6A</span>(<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>##            50    100    200    500   1000
## chi(1) 0.0754 0.0672 0.0643 0.0533 0.0504
## U(0,2) 0.0512 0.0488 0.0503 0.0519 0.0508
## exp(1) 0.0668 0.0576 0.0518 0.0501 0.0465</code></pre>
</div>
</div>
<div id="hw04" class="section level2">
<h2>HW04</h2>
<div id="ex-1-2" class="section level3">
<h3>Ex 1</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span>      </span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>   </span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co"># 初始化结果变量</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>FWER_bonf <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Bonferroni cue FWER</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>FDR_bh <span class="ot">&lt;-</span> <span class="dv">0</span>    <span class="co"># B-H cue FDR</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>TPR_bh <span class="ot">&lt;-</span> <span class="dv">0</span>    <span class="co"># B-H cue TPR</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="co">#simulate</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>  </span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;=</span> <span class="fl">0.95</span>) {</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a>      p[j] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>      p[j] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>    }</span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>  }</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>  </span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>  <span class="co"># Bonferroni</span></span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>  p_bonf <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a>  </span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a>  <span class="co"># B-H</span></span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>  p_bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a>  </span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a>  </span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a>  reject_bonf <span class="ot">&lt;-</span> p_bonf <span class="sc">&lt;=</span> alpha</span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a>  reject_bh <span class="ot">&lt;-</span> p_bh <span class="sc">&lt;=</span> alpha</span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a>  </span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a> </span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a>  FWER_bonf <span class="ot">&lt;-</span> FWER_bonf <span class="sc">+</span> <span class="fu">sum</span>(reject_bonf)</span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a>  FDR_bh <span class="ot">&lt;-</span> FDR_bh <span class="sc">+</span> <span class="fu">sum</span>(reject_bh <span class="sc">&amp;</span> <span class="sc">!</span>reject_bonf)</span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a>  TPR_bh <span class="ot">&lt;-</span> TPR_bh <span class="sc">+</span> <span class="fu">sum</span>(reject_bh)</span>
<span id="cb32-36"><a href="#cb32-36" tabindex="-1"></a>}</span>
<span id="cb32-37"><a href="#cb32-37" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" tabindex="-1"></a></span>
<span id="cb32-39"><a href="#cb32-39" tabindex="-1"></a>FWER_bonf <span class="ot">&lt;-</span> FWER_bonf <span class="sc">/</span> (M <span class="sc">*</span> m)</span>
<span id="cb32-40"><a href="#cb32-40" tabindex="-1"></a>FDR_bh <span class="ot">&lt;-</span> FDR_bh <span class="sc">/</span> (M <span class="sc">*</span> m)</span>
<span id="cb32-41"><a href="#cb32-41" tabindex="-1"></a>TPR_bh <span class="ot">&lt;-</span> TPR_bh <span class="sc">/</span> (M <span class="sc">*</span> m)</span>
<span id="cb32-42"><a href="#cb32-42" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" tabindex="-1"></a><span class="co"># result</span></span>
<span id="cb32-44"><a href="#cb32-44" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(FWER_bonf, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb32-45"><a href="#cb32-45" tabindex="-1"></a>                   <span class="cn">NA</span>, FDR_bh, TPR_bh),</span>
<span id="cb32-46"><a href="#cb32-46" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb32-47"><a href="#cb32-47" tabindex="-1"></a>                 <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;B-H&quot;</span>),</span>
<span id="cb32-48"><a href="#cb32-48" tabindex="-1"></a>                                 <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)))</span>
<span id="cb32-49"><a href="#cb32-49" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##                FWER FDR      TPR
## Bonferroni 0.019797  NA 0.011094
## B-H              NA  NA 0.030891</code></pre>
</div>
<div id="ex-2-1" class="section level3">
<h3>Ex 2</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span>  </span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)  </span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>mean_bias <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="fu">length</span>(sample_sizes))  <span class="co"># Initialise the matrix storing the mean deviation</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>std_error <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="fu">length</span>(sample_sizes))  <span class="co"># Initialise the matrix for storing standard errors</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_sizes)) {</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>    n <span class="ot">&lt;-</span> sample_sizes[j]  </span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> lambda)  </span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>    X_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)  </span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>    </span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>    <span class="co"># Resampling using the self-help method and calculating the MLE for each resample</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>    bootstrap_estimates <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(<span class="fu">sample</span>(X, <span class="at">replace =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>    mean_bias[i, j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_estimates) <span class="sc">-</span> lambda<span class="sc">/</span>(n<span class="dv">-1</span>)  </span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>    std_error[i, j] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n<span class="dv">-2</span>) <span class="sc">*</span> <span class="fu">mean</span>(bootstrap_estimates) <span class="sc">*</span> (n<span class="sc">/</span>(n<span class="dv">-1</span>))  </span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>  }</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>}</span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>mean_bias_theoretical <span class="ot">&lt;-</span> lambda<span class="sc">/</span>(sample_sizes <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># theory deviation</span></span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>std_error_theoretical <span class="ot">&lt;-</span> lambda <span class="sc">*</span> sample_sizes <span class="sc">/</span> ((sample_sizes <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(sample_sizes <span class="sc">-</span> <span class="dv">2</span>))  </span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a>mean_bias_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(mean_bias, <span class="dv">2</span>, mean)  <span class="co"># Mean value of average deviation</span></span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a>std_error_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(std_error, <span class="dv">2</span>, mean)  <span class="co"># Mean value of standard errors</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a>mean_bias_theoretical  <span class="co"># output theory deviation</span></span></code></pre></div>
<pre><code>## [1] 0.5000000 0.2222222 0.1052632</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>std_error_theoretical  <span class="co"># Output Theory Standard Error</span></span></code></pre></div>
<pre><code>## [1] 1.4433757 0.7856742 0.4962153</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>mean_bias_mean  <span class="co"># Mean deviation of output self-help method</span></span></code></pre></div>
<pre><code>## [1] 2.515319 2.223748 2.095097</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>std_error_mean  <span class="co"># Standard error of the mean of the output self-help method</span></span></code></pre></div>
<pre><code>## [1] 6.528358 7.686942 9.826670</code></pre>
</div>
<div id="ex-3" class="section level3">
<h3>Ex 3</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>T_73 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed=</span><span class="dv">1000</span>){</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>  boot.t.ci <span class="ot">&lt;-</span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>    <span class="cf">function</span>(x, <span class="at">B =</span> <span class="dv">500</span>, <span class="at">R =</span> <span class="dv">100</span>, <span class="at">level =</span> .<span class="dv">95</span>, statistic){</span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>      <span class="co">#compute the bootstrap t CI</span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x); n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>      stat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B); se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>      boot.se <span class="ot">&lt;-</span> <span class="cf">function</span>(x, R, f) {</span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x); m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>        th <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">size =</span> m, <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a>        <span class="fu">f</span>(x[i, ])})</span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">sd</span>(th))</span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a>      }</span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a>      <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb42-17"><a href="#cb42-17" tabindex="-1"></a>        j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-18"><a href="#cb42-18" tabindex="-1"></a>        y <span class="ot">&lt;-</span> x[j, ]</span>
<span id="cb42-19"><a href="#cb42-19" tabindex="-1"></a>        stat[b] <span class="ot">&lt;-</span> <span class="fu">statistic</span>(y)</span>
<span id="cb42-20"><a href="#cb42-20" tabindex="-1"></a>        se[b] <span class="ot">&lt;-</span> <span class="fu">boot.se</span>(y, <span class="at">R =</span> R, <span class="at">f =</span> statistic)</span>
<span id="cb42-21"><a href="#cb42-21" tabindex="-1"></a>      }</span>
<span id="cb42-22"><a href="#cb42-22" tabindex="-1"></a>      stat0 <span class="ot">&lt;-</span> <span class="fu">statistic</span>(x)</span>
<span id="cb42-23"><a href="#cb42-23" tabindex="-1"></a>      t.stats <span class="ot">&lt;-</span> (stat <span class="sc">-</span> stat0) <span class="sc">/</span> se</span>
<span id="cb42-24"><a href="#cb42-24" tabindex="-1"></a>      se0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(stat)</span>
<span id="cb42-25"><a href="#cb42-25" tabindex="-1"></a>      alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb42-26"><a href="#cb42-26" tabindex="-1"></a>      Qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t.stats, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb42-27"><a href="#cb42-27" tabindex="-1"></a>      <span class="fu">names</span>(Qt) <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(Qt))</span>
<span id="cb42-28"><a href="#cb42-28" tabindex="-1"></a>      CI <span class="ot">&lt;-</span> <span class="fu">rev</span>(stat0 <span class="sc">-</span> Qt <span class="sc">*</span> se0)</span>
<span id="cb42-29"><a href="#cb42-29" tabindex="-1"></a>    }</span>
<span id="cb42-30"><a href="#cb42-30" tabindex="-1"></a>  </span>
<span id="cb42-31"><a href="#cb42-31" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(law<span class="sc">$</span>LSAT, law<span class="sc">$</span>GPA)</span>
<span id="cb42-32"><a href="#cb42-32" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="cf">function</span>(dat){<span class="fu">mean</span>(<span class="fu">cor</span>(dat[,<span class="dv">1</span>],dat[,<span class="dv">2</span>]))}</span>
<span id="cb42-33"><a href="#cb42-33" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.t.ci</span>(dat, <span class="at">statistic =</span> stat, <span class="at">B=</span><span class="dv">2000</span>, <span class="at">R=</span><span class="dv">200</span>)</span>
<span id="cb42-34"><a href="#cb42-34" tabindex="-1"></a>  <span class="fu">print</span>(ci)</span>
<span id="cb42-35"><a href="#cb42-35" tabindex="-1"></a>}</span>
<span id="cb42-36"><a href="#cb42-36" tabindex="-1"></a><span class="fu">T_73</span>()</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.1603898  0.9979109</code></pre>
</div>
</div>
<div id="hw05" class="section level2">
<h2>HW05</h2>
<div id="section-8" class="section level3">
<h3>7.5</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile,and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>hours <span class="ot">=</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(hours)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">200</span> </span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="co">#MLE</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>mle.lambda <span class="ot">=</span> <span class="cf">function</span> (values) {</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">length</span>(values)<span class="sc">/</span><span class="fu">sum</span>(values))</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>}</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>time.b <span class="ot">=</span> <span class="fu">numeric</span>(B) </span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>ts <span class="ot">=</span> <span class="fu">numeric</span>(B) </span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>time.hat <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mle.lambda</span>(hours) </span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a><span class="co"># B times bootstrap sampler</span></span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>  i <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>  hours.b <span class="ot">=</span> hours[i]</span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>  time.b[b] <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mle.lambda</span>(hours.b)</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>  </span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>  times.b2 <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>  </span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>  <span class="co"># Calculate parameter estimates for each bootstrap sample</span></span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>  <span class="cf">for</span> (b2 <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a>    i2 <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a>    hours.b2 <span class="ot">=</span> hours.b[i2]</span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a>    times.b2[b2] <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mle.lambda</span>(hours.b2)</span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a>  }</span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>  <span class="co">#Calculate the t-statistic for each bootstrap sample</span></span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a>  ts[b] <span class="ot">=</span> (time.b[b] <span class="sc">-</span> time.hat) <span class="sc">/</span> <span class="fu">sd</span>(times.b2)</span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a>}</span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a><span class="co">#Calculate the standard error of the parameter estimates for the bootstrap sample</span></span>
<span id="cb44-34"><a href="#cb44-34" tabindex="-1"></a>se.hat <span class="ot">=</span> <span class="fu">sd</span>(time.b)</span>
<span id="cb44-35"><a href="#cb44-35" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span>;</span>
<span id="cb44-36"><a href="#cb44-36" tabindex="-1"></a>q.probs <span class="ot">=</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb44-37"><a href="#cb44-37" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" tabindex="-1"></a>setCINames <span class="ot">=</span> <span class="cf">function</span> (object) {</span>
<span id="cb44-39"><a href="#cb44-39" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">setNames</span>(object, <span class="fu">c</span>(<span class="fu">paste</span>((alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&#39;%&#39;</span>), <span class="fu">paste</span>((<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&#39;%&#39;</span>))))</span>
<span id="cb44-40"><a href="#cb44-40" tabindex="-1"></a>}</span>
<span id="cb44-41"><a href="#cb44-41" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" tabindex="-1"></a><span class="co"># Calculate confidence intervals for the standard normal distribution</span></span>
<span id="cb44-43"><a href="#cb44-43" tabindex="-1"></a>q <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb44-44"><a href="#cb44-44" tabindex="-1"></a>ci.sn <span class="ot">=</span> time.hat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span>q<span class="sc">*</span>se.hat</span>
<span id="cb44-45"><a href="#cb44-45" tabindex="-1"></a>(<span class="at">ci.sn =</span> <span class="fu">setCINames</span>(ci.sn))</span></code></pre></div>
<pre><code>##     2.5 %    97.5 % 
##  32.40494 183.76173</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># basic boostrap.</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>qs.time.hat <span class="ot">=</span> <span class="fu">quantile</span>(<span class="at">x =</span> time.b, <span class="at">p =</span> q.probs)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>ci.basic <span class="ot">=</span> <span class="fu">rev</span>(<span class="dv">2</span><span class="sc">*</span>time.hat <span class="sc">-</span> qs.time.hat)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>(<span class="at">ci.basic =</span> <span class="fu">setCINames</span> (<span class="at">object =</span> ci.basic))</span></code></pre></div>
<pre><code>##    2.5 %   97.5 % 
##  24.0125 167.5896</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>(<span class="at">ci.percentile =</span> qs.time.hat)</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
##  48.57708 192.15417</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Bootstrap t method</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>qs.t <span class="ot">=</span> <span class="fu">quantile</span>(<span class="at">x =</span> ts, <span class="at">p =</span> q.probs)</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>(<span class="at">ci.t =</span> <span class="fu">setCINames</span>(<span class="fu">rev</span>(time.hat <span class="sc">-</span> qs.t<span class="sc">*</span>se.hat)))</span></code></pre></div>
<pre><code>##     2.5 %    97.5 % 
##  45.23157 285.79873</code></pre>
</div>
<div id="section-9" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of θ.hat.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="at">seed=</span><span class="dv">100</span>)</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>sc<span class="ot">&lt;-</span>scor</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="cf">function</span>(x){ </span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>  sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(x)</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>  pca.sigma<span class="ot">&lt;-</span><span class="fu">prcomp</span>(sigma)</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>  theta<span class="ot">&lt;-</span>pca.sigma<span class="sc">$</span>sdev[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(pca.sigma<span class="sc">$</span>sdev) </span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>  theta</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>}</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">NROW</span>(sc)</span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>theta.j<span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>  theta.j[i]<span class="ot">&lt;-</span><span class="fu">theta</span>(sc[<span class="sc">-</span>i,])</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>}</span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">theta</span>(sc)</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>bias<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.j)<span class="sc">-</span>theta.hat) <span class="co">#Bias</span></span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(theta.j)) <span class="co">#Se</span></span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(bias,se),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.014 0.053</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">list</span>(<span class="at">Bias.jack=</span>bias,<span class="at">SE.jack=</span>se)</span></code></pre></div>
<pre><code>## $Bias.jack
## [1] 0.01433958
## 
## $SE.jack
## [1] 0.05299504</code></pre>
</div>
<div id="section-10" class="section level3">
<h3>7.11</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,n)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  </span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n<span class="dv">-1</span>){</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>    </span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>    e1[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>    </span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span></span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>      chemical[<span class="fu">c</span>(i,j)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>    e2[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>    </span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>    e3[i,j] <span class="ot">&lt;-</span><span class="fu">mean</span>(( magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a>    </span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[<span class="fu">c</span>(i,j)])</span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>    e4[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a>    </span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a>  }</span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a>  </span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a>}</span>
<span id="cb56-33"><a href="#cb56-33" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(e1)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)),<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(e2)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)),<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(e3)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)),<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(e4)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)))</span></code></pre></div>
<pre><code>## [1] 18.50408 16.55759 17.06077 19.09614</code></pre>
</div>
</div>
<div id="hw06" class="section level2">
<h2>HW06</h2>
<p>###Ex 1 Proof the Stationarity of Metropolis-Hastings sampler
Algorithm in continuous situation.</p>
<p>if <span class="math inline">\(π\)</span> and <span class="math inline">\(P\)</span> ： <span class="math display">\[
πP = P
\]</span> Then the distribution <span class="math inline">\(π\)</span>
is said to be the smooth distribution of a Markov chain with <span class="math inline">\(P\)</span> as the state transfer matrix. if :
<span class="math display">\[
\forall i,j\in S\qquad π_{i}P_{ij}=π_{j}P_{ji}
\]</span> Then the state distribution <span class="math inline">\(π\)</span> is said to satisfy the meticulous
smoothness condition for Markov chains. Based on the M-H principle of
operation: (1)when <span class="math inline">\(i\neq j\)</span> <span class="math display">\[
P(X_{n+1}=j|X_n=i) = P(X_n=j|X_n=i) \cdot P(u \geq a_{ij}) +
P(Y=j|X_n=i) \cdot P(u &lt; a_{ij}) \\= P(Y=j|X_n=i) \cdot P(u &lt;
a_{ij}) = q_{ij} \cdot a_{ij}
\]</span> (2)when <span class="math inline">\(i= j\)</span> <span class="math display">\[
P(X_{n+1}=j|X_n=i) = P(X_n=j|X_n=i) \cdot P(u \geq a_{ij}) +
P(Y=j|X_n=i) \cdot P(u &lt; a_{ij}) \\= P(u \geq a_{ij}) +  P(Y=j|X_n=i)
\cdot P(u &lt; a_j) = 1 - a_{ij} + q_{ij}  = q_{ij}
\]</span> so， <span class="math display">\[
p_{ij}=a_{ij}q_{ji}
\]</span> <span class="math display">\[
\begin{aligned}
\pi_{i}p_{ij}&amp; =\pi_iq_{ij}a_{ij}  \\
&amp;=\pi_iq_{ij}\min(1,\frac{\pi_jq_{ji}}{\pi_iq_{ij}}) \\
&amp;=\min(\pi_iq_{ij},\pi_jq_{ji}) \\
&amp;=\pi_jq_{ji}\min(1,\frac{\pi_iq_{ij}}{\pi_jq_{ji}}) \\
&amp;=\pi_jq_{ji}a_{ji} \\
&amp;=\pi_jp_{ji} \\
\end{aligned}
\]</span></p>
<div id="section-11" class="section level3">
<h3>8.1</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts) <span class="co"># Attaching the chickwts dataset to the current environment</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="co"># Body weights of chickens fed with the two feed types were extracted separately and ranked</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])) </span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="fu">detach</span>(chickwts) </span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="fu">library</span>(cramer) </span></code></pre></div>
<pre><code>## Warning: package &#39;cramer&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>rep <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) </span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(rep) </span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>T.hat <span class="ot">&lt;-</span>  <span class="fu">cramer.test</span>(x, y)<span class="sc">$</span>statistic</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep) {</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>  <span class="co"># A set of n1 samples is randomly selected without playback from z</span></span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n1, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>  z1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>  z2 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cramer.test</span>(z1, z2)<span class="sc">$</span>statistic</span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a>}</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a></span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span>  <span class="fu">mean</span>(<span class="fu">abs</span>(T.hat) <span class="sc">&lt;</span> <span class="fu">abs</span>(reps))</span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a>p.hat</span></code></pre></div>
<pre><code>## [1] 0.358</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">hist</span>(reps, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">&quot;T (P = 0.75)&quot;</span>, <span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">points</span>(T.hat, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-12" class="section level3">
<h3>8.3</h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  weight <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">*</span> (<span class="fu">length</span>(x)<span class="sc">/</span>(<span class="fu">length</span>(x)<span class="sc">+</span><span class="fu">length</span>(y))))</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  <span class="co"># Calculate the number of X&#39;s greater than Y and the number of Y&#39;s less than Y, and the number of Y&#39;s greater than X and the number of Y&#39;s less than X, based on the extreme values of the samples X and Y</span></span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">min</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> weight <span class="sc">||</span> <span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> (<span class="dv">10</span><span class="sc">-</span>weight) )) <span class="co">#return 1 reject or 0 (receive H0)</span></span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>}</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">*</span> (n1<span class="sc">/</span>(n1<span class="sc">+</span>n2)))</span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(n1 <span class="sc">+</span> n2)</span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a>jg <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb63-26"><a href="#cb63-26" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb63-27"><a href="#cb63-27" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k];y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb63-28"><a href="#cb63-28" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> x1 <span class="sc">-</span> <span class="fu">mean</span>(x1) <span class="co">#centered by sample mean</span></span>
<span id="cb63-29"><a href="#cb63-29" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y1 <span class="sc">-</span> <span class="fu">mean</span>(y1)</span>
<span id="cb63-30"><a href="#cb63-30" tabindex="-1"></a>  jg[i] <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x1, y1)</span>
<span id="cb63-31"><a href="#cb63-31" tabindex="-1"></a>}</span>
<span id="cb63-32"><a href="#cb63-32" tabindex="-1"></a></span>
<span id="cb63-33"><a href="#cb63-33" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">mean</span>(jg) <span class="co">#Calculate the mean of the vector of experimental results jg, indicating the proportion of rejections of the null hypothesis</span></span>
<span id="cb63-34"><a href="#cb63-34" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(q),<span class="dv">3</span>) <span class="co">#A simulation experiment for comparing the difference between two normally distributed samples was performed by rejecting H0</span></span></code></pre></div>
<pre><code>## [1] 0.068</code></pre>
</div>
</div>
<div id="hw07" class="section level2">
<h2>HW07</h2>
<div id="ex-1-3" class="section level3">
<h3>Ex 1</h3>
<p><span class="math display">\[P(Y=1\mid
X_{1},X_{2},X_{3})=\frac{\exp(a+b_{1}X_{1}+b_{2}X_{2}+b_{3}X_{3})}{1+\operatorname{exp}(a+b_{1}X_{1}+b_{2}X_{2}+b_{3}X_{3})},\mathrm{where}X_{1}\sim
P(1)
，X_2\sim Exp(1)，X_3\sim B(1,0.5).\]</span> ●Design a function that
takes as input values N, b1, b2, b3 and  f_0, and produces the output
a.s ●Call this function, input values are N = 10E6,b1 =0,b2= 1,b3= -1,
 f_0 = 0.1, 0.01, 0.001, 0.0001. ●Plot-<span class="math inline">\(\operatorname{log}f_0\)</span> vs a</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>ex1 <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f_0) {</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N, <span class="dv">1</span>)</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  X3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  <span class="co">#change traverse</span></span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">log</span>(f_0) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">log</span>(f_0)) <span class="sc">-</span> b1 <span class="sc">*</span> <span class="fu">mean</span>(X1) <span class="sc">-</span> b2 <span class="sc">*</span> <span class="fu">mean</span>(X2) <span class="sc">-</span> b3 <span class="sc">*</span> <span class="fu">mean</span>(X3)</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>  </span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>}</span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a>f_0_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a>a_values <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a>log_f_0_values <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a></span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a><span class="cf">for</span> (f_0 <span class="cf">in</span> f_0_values) {</span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">ex1</span>(N, b1, b2, b3, f_0)</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>  a_values <span class="ot">&lt;-</span> <span class="fu">c</span>(a_values, a)</span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a>  log_f_0_values <span class="ot">&lt;-</span> <span class="fu">c</span>(log_f_0_values, <span class="fu">log</span>(f_0))</span>
<span id="cb65-24"><a href="#cb65-24" tabindex="-1"></a>}</span>
<span id="cb65-25"><a href="#cb65-25" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" tabindex="-1"></a><span class="fu">plot</span>(log_f_0_values, a_values, <span class="at">xlab =</span> <span class="st">&quot;log(f0)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;a&quot;</span>, <span class="at">main =</span> <span class="st">&quot;log(f0) vs a&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkDqQkGaQkLaQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2kGa2tma225C229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb////tmb/25D/27b//7b//9v///+Jr8gnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAH+ElEQVR4nO2dC5uiNhSG4+xMtZ1uL+NeWm27u21le9kOexFH+f8/rDkJICrwJchN+d7nGcfREOSd5CTIAVRMKlF9f4ChQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQE6F7Rbqrt1+dvb+WQV797PlPpB/1Jq8loX3sxuHrv7hIcMTVAo70ZK86BLClOzzEN3n/CQgQmyKkKlm5E8vos/KrVItPVDb4I+v1Lq2Wuz2dKVbleB0v0oEjWBNJzJn8uk8Uylj4kmwZSKpY3pFz7e63Lff8jq/vxSL/h81ejn7UtQaLqPeWq70uReNj2UByvoj7npV4GU2c7TPmbN2FeTOrL4FNm/J40a6kmQbhJ2Cx/Mdk3Xu0C21LYX28V0EStIBARpH7MljDD9MF3Hn1TqTr/11TpdrDF6EpT0lMA2GHmuN/fmUbY5LhaUtpPQNjRb4Pbfo9q//HVvwnpz9CMoDUSyoelzcZBIORUUZh1HwpFdxHbNJI6Zqn9V6bjXHP0ISlqKiSjpc0dB0seSt55e2pjze/aOun37ZX4Nglxa0DYXpHOCpI/9lv719OY+ifRxnBjdXoWgshiUF5T1oywqWXQZlZsW7X5Jw5Md4K4kSJeMYvkgLY8/JxPFXJCOzSxAXtPL/biWfrZvQXfrp+VVxKCyedBBe9nvauSG+diIsbbeH857kvJXIsjOpH+yL+kt/e5DYMfvXMSRfVazs3q4M7aPMp8kAj3PZtIyit2+C1Wje7bD+bojsLuphfPgzazZ6bEHAxAUyFcbEkHsrteioEg0op3VU5JdKNt2wsIIEozo644Cnl7Nsr3y7bwggozqC7NLg4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQoI6gzWzR9McYLj6CtnOV0d+x4I7xakGRzSGoaEHqYmhFkG5Dd+tqQV7V9UHipiVBcRyYBN1FU9V1jsr9OC/gRageLliQSh/bE6Tbz7MTQf5duye6EFSWJle3uk7pSFB5PtzQBXUQgy5cUOujWHzpghIoCEBBgDYFdVhde1AQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAdC7qYI6sZbEEACgJQEICCABQEoCAABQHGIeiMedcoBHklQhUs22zBXqpzWFfNNVKQ08JNFuylOod1UVD1yhiDKtfGUaw1KAhAQQAKAlAQoCVBgVJTc2X0RSPV9Ug7gkJzPwNz65iSXPJxCzIp9pG9LnbJFcKvWVB6TnP5+czb+UILsrevKil1zYKCu3U4rTwnftwtSMJKJDcDqbi8fhaDSs9nuWpBi3jzzaP5KaVsFBvDkVVpFNsXq2pBza23b2rEoFDuQ/RQ2cUsoz1fLJjaWzShRUYryBUKAlAQgIK6WG/fUBCAggAUBKAgAAUBKAhAQQAKAlyeoI6/S7o4QedkatRdX7MF263urFyf+itssmC71VGQ03IUVL0gY1DlkhzFBgUFAToWNIYDhx2vt28oCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFARoSVCY5pCHIzxXw4Fwsoq382lMQcXY7M3dUs7ooKACzOlQsT0viIIKyPJ/gykFFZJqKT9jYeSC9Ci2ML93Swo6Y72XcPSnT0FdH2avRY+COk/UqEWPR1ZHLMjhZtjjFlQ+eB1UN+YYtFtOHaob8ygWld+kt051/dHbKHYx9CQI1+z1cnuFnamxeNU5q7hmCgI1UxComYJAzRQEah6BoPNqpiBQMwWBminoyqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA9gSFSplrc7sQJcdiFk6l7SFwcAiz1ucooDVBgf5UVZc3P8Xmzzqw+dpjgyUrLjrDUFuC7H0T8LWXc5TlPZ5QdkH90s8Bj5hX0JYg+0/z+ddtZk5fdWtC380dsCDHqCIEzu0i+FaHIFebQjjALmbDT+guqPReJgUlpeMGzoYiP5tHtByk3QX5BlKfQGRODqhJe8N8oNTNfy+ctzrw3AavEfKMYawFQeE+QjjcYiEp7dbD8lXDsT5f2Gu+cUC7M2n3Yd5jE2xRxy7mVbiI9uZBU6+W7dMJAhm0XYO0dF3Hg+WFtNaCZH/AY6OdZ4lC4LxX4lv4FO6sAigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAYQlKr/V5xG65kGSWB0kWk+P9W/e0o7O5CEHh1OYPSQqISQOJ6meM+XIJguRV+bFZLJL8Ik2qIwYoKEozwwLdod5Io7l53MyUuvnHJoZKooxXAvZZDE+QpA6b9CvJC44k5kibkXds1p3JFjsnd96PwQmy/UgLsMlzwWRlwo9Rt09OPyPp0JPBCbKbrh9tXmEkghYngtyzqs9loIL0kzAVZF456mKjF1TYgjb7ID1iQUcxKMzFoP0wP+YYVDGK7SeKYx7FDudBN3+LJf1jp5DZ2YNjnQedspeTp2SXpA2GKygZvMyJi8fnw412X+yAKDvN93jXa7x78wOEggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+B04S2tdG3SZVAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="section-13" class="section level3">
<h3>9.4</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma, x0, N) {</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="sc">-</span>.<span class="dv">5</span>,.<span class="dv">5</span>)</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>  R <span class="ot">&lt;-</span> mu<span class="sc">-</span>b<span class="sc">*</span><span class="fu">sign</span>(u)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1-2</span><span class="sc">*</span><span class="fu">abs</span>(u))</span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>    <span class="cf">if</span> (R[i] <span class="sc">&lt;=</span> (<span class="fu">dt</span>(y, n) <span class="sc">/</span> <span class="fu">dt</span>(x[i<span class="dv">-1</span>], n)))</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>        k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a>      } }</span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>}</span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#t</span></span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb66-20"><a href="#cb66-20" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb66-21"><a href="#cb66-21" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb66-22"><a href="#cb66-22" tabindex="-1"></a>rp1 <span class="ot">&lt;-</span> <span class="fu">Metropolis</span>(n, sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb66-23"><a href="#cb66-23" tabindex="-1"></a>rp2 <span class="ot">&lt;-</span> <span class="fu">Metropolis</span>(n, sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb66-24"><a href="#cb66-24" tabindex="-1"></a>rp3 <span class="ot">&lt;-</span> <span class="fu">Metropolis</span>(n, sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb66-25"><a href="#cb66-25" tabindex="-1"></a>rp4 <span class="ot">&lt;-</span> <span class="fu">Metropolis</span>(n, sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb66-26"><a href="#cb66-26" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>rp1<span class="sc">$</span>k<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>rp2<span class="sc">$</span>k<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>rp3<span class="sc">$</span>k<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>rp4<span class="sc">$</span>k<span class="sc">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.5020 0.4710 0.4365 0.4125</code></pre>
</div>
<div id="section-14" class="section level3">
<h3>9.7</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">5000</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">0.9</span></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>mu1 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>mu2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>sigma1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>sigma2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a><span class="co">#Calculate the standard deviation to ensure that the generated data meets the set correlation</span></span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>mean12 <span class="ot">=</span> <span class="cf">function</span> (x2) mu1 <span class="sc">+</span> rho<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2<span class="sc">*</span>(x2 <span class="sc">-</span> mu2)</span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>mean21 <span class="ot">=</span> <span class="cf">function</span> (x1) mu2 <span class="sc">+</span> rho<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1<span class="sc">*</span>(x1 <span class="sc">-</span> mu1)</span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a><span class="co">#Let the initial sample point be the mean</span></span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a>x[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a><span class="co">#Generate residual samples</span></span>
<span id="cb68-19"><a href="#cb68-19" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb68-20"><a href="#cb68-20" tabindex="-1"></a>  xt <span class="ot">=</span> x[i<span class="dv">-1</span>,]</span>
<span id="cb68-21"><a href="#cb68-21" tabindex="-1"></a>  xt[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean12</span>(xt[<span class="dv">2</span>]), s1)</span>
<span id="cb68-22"><a href="#cb68-22" tabindex="-1"></a>  xt[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean21</span>(xt[<span class="dv">1</span>]), s2)</span>
<span id="cb68-23"><a href="#cb68-23" tabindex="-1"></a>  x[i,] <span class="ot">=</span> xt</span>
<span id="cb68-24"><a href="#cb68-24" tabindex="-1"></a>}</span>
<span id="cb68-25"><a href="#cb68-25" tabindex="-1"></a><span class="co">#Discard the initial burn sample points and keep the remaining samples.</span></span>
<span id="cb68-26"><a href="#cb68-26" tabindex="-1"></a>x <span class="ot">=</span> x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m,]</span>
<span id="cb68-27"><a href="#cb68-27" tabindex="-1"></a></span>
<span id="cb68-28"><a href="#cb68-28" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb68-29"><a href="#cb68-29" tabindex="-1"></a>lin.reg <span class="ot">=</span> <span class="fu">lm</span>(X1 <span class="sc">~</span> X2, <span class="at">data =</span> x)</span>
<span id="cb68-30"><a href="#cb68-30" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb68-32"><a href="#cb68-32" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">main =</span> <span class="st">&quot;生成数据&quot;</span>)</span>
<span id="cb68-33"><a href="#cb68-33" tabindex="-1"></a><span class="fu">hist</span>(lin.reg<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">&quot;线性模型残差&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABFFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtmAABmADpmOgBmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkJBmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQZjqQZmaQkGaQkJCQkLaQkNuQtraQttuQtv+Q29uQ2/+2ZgC2Zjq2Zma2kDq2kGa2kJC2kLa2tma2tpC2tra2ttu225C227a229u22/+2/7a2/9u2///T09PbkDrbkGbbkJDbtmbbtpDbtrbb25Db27bb29vb2//b/7bb/9vb////tmb/tpD/trb/25D/27b/29v//7b//9v////nTl7GAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPXElEQVR4nO2dfUPbRhLG14Br5WoSuOCSa0lDC05ISJsrpsAV5VpaKhrSOD2rNbH0/b/HzeyuJNtYHml3LRR3nj/AL/Lu6Kd5WUkrScSsuRJ3bUDdxYAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEJ2gIL2wwGxyEl7D/4ey79SYXt3EIoNH3Ta3jLrNzp7Cf0O2xsX6UfH7a/kN6eP08/+3NkdxNHB+lGgvptU2N4ct/2qvZe9vd6R5g5hEXNAJ+uv4kDcWsPoafvJiy91X1frRz2x12183RH7qWGiCYBa+DIQm2Z9jzqNI7DfWztpJIy0KVG3MdYTNt9rHKVmvsXN4h+LlQv8tpV8cgwmBeLBdsY7gE/wb8sc0KgDvc4AFPfE1tBD+9WKfCqEaA29Zrp50LAUkKEHqR+OOrhereyjyPf/19Vdy562bny/29g9EQ86uque2Adi4Bv3T/Qve2rbwe9DsXKZrh28HD26P4iMAcl1VoZ+6I9/AYDiY7GpPjtufyoaGwO1XF+bbQ1otL32y/OdC7kW14cKPbYF2+PbSUCx9KAw60cC2u1fey1tQ6R/AMtEzx/LttCrzg4xA+z6z4wB9TCNHOCfU6H6H3rr3/r4WdP3T4SAKH4Hb7tiY1uIxq7vb4PDRvIrUNOXi5oBCsT+0Fu5uAEe553VdQyM/rEQay+8JnpQ1H8fx7qntV9OHw+GOwoa+pN42JUGJIBGj9YvFaAWtLGWBpl2+r4pINiIl1MuADZfxklsK/VhCSCFKSPZUqkHQaJ+8eDfJn1D7uwD98MfO1lIHHbkam+cbzd2nwnVlXSq549xUzxqyzjqD8CfZIilHgSJDHLQ6s4XoolcUdFbmZc+8XGjmgIKZeTOBgTo375OFkN5YPEoWRs07E0WZgbqibVt7Fg2GfmvZd8KTrYdMHhk1GG30VPlJvDZyuUkIPBGmYbk235/rBOV7A0B6XCdBQj/jTpJ1DWfSUQYEzpPh2IVEvcGBEDzfNs0CUH6hL/dxoPHB+s7r5AFxDl4VjwGCKGt/Qhh6PvnOo4QTDwBKHp6b0/+Brbr+UEbKrPuIdmehoCud+TPJaAP/YHuHGx5Kv7ZwboqafwJ44/j9aO/Dn8+/CZ1mCvR2AuSTWYmWKPvTnd2ffCYWMVFv38itn4DoyKZgwbKONCqN+5BEgX6RvS2fyX7R4pg8QMMsYsbH1OQrPynYu1blSZNjfygfr7h/+DpNUUfQQtw5CM9I/Lfx6rig8OdKGe5hqhWG9EcUNQTu/7zJxe4qqHQ455APOyDRRBmT7AawFLguw+ff+GNe9DVPTDm7BAwfICkvi8N+91Di9BlfumKdOyYRJjtSHoyxBQg3HLKP9/Kmnbq3R/gZ9jjCHNpCyKisQEhdmw2UITEtvZKdb/qJeNCaUp/kIUYpr8tDEZIeNH369/Bql8fyiJ1ffgT/JWu98EfxH0JQ0ZpK+tCW2ZcxcasSoTxjfah1yqro/5oe+USFwpFOggLcdwo9EjVKAVFSS4dYvbX77KRtAIUHb4Mk8HEBjiW9KrE6s0sMSQFGSMyHc2OHrVlgFlUsaSrsTUMk6LRk3XM11lcDUo76ZIACP3JAhAqenfmD95IH9n5asyUFBAA0Gm4K7L9nJvxxDCYWIkABwd/+cgKUtZFMhJyCCiAocmphztaQmzqMhe9O4CK9R7qerp5QvHJ0/VzzxxQ9NtOW2y8GtwciAee2AvTXQX55cRIWqXhle3ss/6tblVFvOmKT8Xa5dnLOOHjEtANekv0dGMAPr8Ves13HbHaVkF8s93Y8RpQIk7UKDXqv1FFH4uE4Uj6Cgp7HB17sG+JwXobkC5joUq+2Ftjb+z3gS4hMiHJAhedepvvMchWweqbRxvy5zaAIrVbrHY1/FNZx9SWjK7ufYVYVML7cNzYHSAksA/Kxv2LOILxf+Oh7twixG78n5QlxyKJkE1fVbHd845yVwSk+pbjyAu565Na3VX173T9Ijr/10uJBEos1Bn/tQxEWC3YiKfODpiNnn+D9p7pwzE3Zy8H8AbX4vrRrtoHfC3/9f8D/jaUB2Pe7Bzltldcyl3GjjglCttrB23Vd3R2iMmlP70IfD5xQCvZ28jERxQJMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAg5BiRy5baf6uQaUEX9VKdKAIH/MKA5zYmYQ2xuc+hAdQBktJkqCrF6APqVAc1VjQHVo4rVFlBNxkGiroBETcp8fQGxB81trja7GvUElOBhQLObE0mKZkCzmxMJHwaU05wQnKTnNVen40F1BJT6DwOa3RwDoppLq3zpfkYd8xsPzFadARmV+UAI80s2Z6iOgLIIM+vHKaNaArKuYtltHKxVBaDkDhNxkGP0ZHO2p31C2V3UbQ7oZWlVAChoHEHyxNxZASC8zYciE5Z2oZndLh5Q1JUX5OMGXTwgdaM7W411KxYPaNRR98DoNQdTgHI42IaYvaYBlTejvAeBeq1CHjSOxwAQbIc4tCxi1QJKAwvSQzlAJtWyJxOQSnnGqhiQvCMaCu+VRjdnBSiJ5/IZOseeSgCVa84qxJJ4zgvm0vYsGyDtrUPPKgl9LICM+pH3BrKs9bUGJCwBObaHARH21BmQUT+Ruimt3a7qMgPqudiJX2JAo46LA0F1BiRsAe3TC5W0p1aAJvmYDBRdHJJeYkD6toPzRSbyJQY06giyiqX3Yczd6a8xoNjWg2ilh18AVc5R2RoDEpMutAhAY3k8b5+/voCEPaAR3nG0N6fYf9QeNMXHJEk3jmC15w6HksNTH2EOmuZjdjwomHN6QCrJ5LnnhdwBIs94lWtuOsLMBooIqCZHFOkzXqWaE/aAEg/qWZ01dAWowBmvUgY5AKRzUDB3uFjZQDH/jJehQfY5SCeYuUcUqxsoFjjjVc4gF4BIVVnm6TNe5QyqBFD+QHGq8+QzuypGnPEqZ9A0n4Xsi9VuoGjmQeX7GdfcKn83A8Xv5+Wgggbd4mMeYr15h4XKDxRL26Gr2JfJe/0MLEuDHAJyPFA0BZRMxulZzndzD8jxqWdDQDjAaclzmZbHOZ0DKjK7Y+jlDiYnd54tAGFaaXxhe6I3ae42H/MqNmdPIy10+bUu6/9XW0DaiSylditcACqiMHlQYAEPsgYUoAdZn6vT+10VAZKPoq0GkJr4P/YUMENNh9htS4uqQPyg1BMdFw7IcRVzASh9UClx8ifAJycvHlDBcVDB5lwAirr64Y7U8aCht1pJDko1ZyRdsLkZfAxC7DP9YF9yg0F1qRSQlbC5GTXMwoMcHVFcPkB4RDFWx4It7VEv6gnIJkmrOmZ5HUvNAcVWgFzZo17UB9BMB2JAWXMz+Szk1HMxe/SL+gDKuVirdFMFTj0Xs0e9qCUguzJf4NRzIXvUi6UD5PjUc40AOcpBjk89Lx+gQqeei9ijX9QH0OxL5U0Hiq4uZllGQK7sUS+WDtDYWUpLe9SLuwU0nnZmpiCzKubEHv1JfTxoJh+TJO3yYhaxfICKTCQvZI/6nwIqi8g5oNl87jpJZ4DK3n3BNaDZoyAGlDbnBpCba6HiOgJyE2ISkItCX0NA8Uw+DChrbiYfBpQ2J+kwoNzmkpu32vWzzIByxmIMKGnOEaBstOB4JH3XgPIG83c7UBQ1A2TtQc5UP0DxzBrGgNLmPoIQK2fKIgaKFfRTVPUDlHe8hQGlljAgojkGNHfabV73fwtAZab+2/TjUBV7UImp/1b9uNNMQKUQld1Hoqb+57W3GEDFrsKWi4wBKjVWLGs4NfW/0hxU8CrsCe9ZNCBy6n+FZb7gNbTiNqAS1pQ3fNbUfzEuR/3QKnIVdp4Kd2Jg+Nyp/1WGWAEPspcRoPwjfdVWMfoqbHt91ICKXLdpq48bUAVyDcg+K7rWXSTpOQEvcv7enUSc7ENnr0oY5dp8BlSoPQZEtMeAiPYYENEeAyLaY0BEewyIaI8B/X3EgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyK0AEB2d9twqeE/kjP26gyjya1Y3QMKF3mes5RGnXRKw/Ce6S0unAOS941y3aiRwrGJVeYX4TsHFDSf1QNQKLYyLIHxjY5dAwJfrk8OygD12pCCjGaAOAaEp6VrCEjNrTS6YZxjQPb3jHKpqcxjlIjcApLForaA5sytzJczQPiAsq1ATy5xdN8EG1PwxTQgk1q/1APFFJDynRqEmFQNAannu9QhSaNqBkg9E7lnGvi8s0qIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFadkCjzy3Pg7sHNPTUuXl996NsKq4rjTr7hR9M0ps38y5rJZzxnDf97QI8SN0OauhtqW5cPORpQiUe29Jb+fnz3wtMm6oWEJh1qedUTEzFdaXigIbePoRYgdkmFQMadVr68agTU3HdNS9DbNT5upNMaRl99gI3RDq1DCKr8aJxpADd/n7oyckwCkGglpVv5B89UwZf44KOrZcaek9Sv14gINjs+mnrahZrIG+CuaVcOBS40s0/FKCJ7+V8s1CoTJYtq6HgXCtcEl7jgoupYkGWGRcIaCudlylfq6ceQ3/qQ3XPUHWBxuT3iUnKR/SyCaDRZ0eqWXiNCy4EUNR1cRFAnlJA+2mikP9UIoF1U12qt3gVy9bU90nhwE/TZcebC3UA4oILAdRr/tFJ5v5XCCiZYhuMA4IkvXI5+b26R65qIbgFCHLSyn+VB8kFHVuPgvDObv1YtQelXaaAhveOJr+X0lF1y4NkzOkQw+UWAGjotZQBY9a6VB6gtPyrvAKJFtf788FU/Ey2ki6bpDRpbygWCCjqSiSqcFQJSJU03DATVQyjffJ76UoJNvwQl426zQHepVY5j8pbuKBzQOmtcEN1gd/CAeGQVHPCcY7sDoYyKz/I4aq6znDqe8xGqpDH6ThIpvOvVQ5qHCUBeJd3yFy01Jap4c7q3UvmFTXqsdcyAlIF3fGDSFk5YkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEfo/l+MuZpDBz7gAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
</div>
<div id="section-15" class="section level2">
<h2>9.10</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>rayleigh_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>}</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a><span class="co"># Metropolis-Hastings</span></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>metropolis_hastings_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma, initial_value) {</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> initial_value</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>  </span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">rayleigh_pdf</span>(y, sigma) <span class="sc">/</span> <span class="fu">rayleigh_pdf</span>(x, sigma)</span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a>    <span class="cf">if</span> (u <span class="sc">&lt;=</span> alpha) {</span>
<span id="cb70-18"><a href="#cb70-18" tabindex="-1"></a>      x <span class="ot">&lt;-</span> y</span>
<span id="cb70-19"><a href="#cb70-19" tabindex="-1"></a>    }</span>
<span id="cb70-20"><a href="#cb70-20" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> x</span>
<span id="cb70-21"><a href="#cb70-21" tabindex="-1"></a>  }</span>
<span id="cb70-22"><a href="#cb70-22" tabindex="-1"></a>  </span>
<span id="cb70-23"><a href="#cb70-23" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb70-24"><a href="#cb70-24" tabindex="-1"></a>}</span>
<span id="cb70-25"><a href="#cb70-25" tabindex="-1"></a></span>
<span id="cb70-26"><a href="#cb70-26" tabindex="-1"></a><span class="co"># Gelman-Rubin</span></span>
<span id="cb70-27"><a href="#cb70-27" tabindex="-1"></a>gelman_rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb70-28"><a href="#cb70-28" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(chains) </span>
<span id="cb70-29"><a href="#cb70-29" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">sapply</span>(chains, length))</span>
<span id="cb70-30"><a href="#cb70-30" tabindex="-1"></a>  <span class="co"># Intercept all chains to the same length</span></span>
<span id="cb70-31"><a href="#cb70-31" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chains, <span class="cf">function</span>(x) x[<span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb70-32"><a href="#cb70-32" tabindex="-1"></a>  <span class="co"># Calculate the mean value of each chain</span></span>
<span id="cb70-33"><a href="#cb70-33" tabindex="-1"></a>  chain_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, mean)</span>
<span id="cb70-34"><a href="#cb70-34" tabindex="-1"></a>  <span class="co"># Calculate the mean of all chains</span></span>
<span id="cb70-35"><a href="#cb70-35" tabindex="-1"></a>  all_means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">do.call</span>(rbind, chains))</span>
<span id="cb70-36"><a href="#cb70-36" tabindex="-1"></a></span>
<span id="cb70-37"><a href="#cb70-37" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(chain_means)</span>
<span id="cb70-38"><a href="#cb70-38" tabindex="-1"></a>  </span>
<span id="cb70-39"><a href="#cb70-39" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(chains, var))</span>
<span id="cb70-40"><a href="#cb70-40" tabindex="-1"></a>  </span>
<span id="cb70-41"><a href="#cb70-41" tabindex="-1"></a>  var_hat <span class="ot">&lt;-</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n) <span class="sc">*</span> W <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> n) <span class="sc">*</span> B</span>
<span id="cb70-42"><a href="#cb70-42" tabindex="-1"></a>  <span class="co">#result</span></span>
<span id="cb70-43"><a href="#cb70-43" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_hat <span class="sc">/</span> W)</span>
<span id="cb70-44"><a href="#cb70-44" tabindex="-1"></a>  </span>
<span id="cb70-45"><a href="#cb70-45" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb70-46"><a href="#cb70-46" tabindex="-1"></a>}</span>
<span id="cb70-47"><a href="#cb70-47" tabindex="-1"></a></span>
<span id="cb70-48"><a href="#cb70-48" tabindex="-1"></a></span>
<span id="cb70-49"><a href="#cb70-49" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span>  </span>
<span id="cb70-50"><a href="#cb70-50" tabindex="-1"></a>initial_value <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb70-51"><a href="#cb70-51" tabindex="-1"></a>target_R_hat <span class="ot">&lt;-</span> <span class="fl">1.2</span>  <span class="co"># Gelman-Rubin</span></span>
<span id="cb70-52"><a href="#cb70-52" tabindex="-1"></a></span>
<span id="cb70-53"><a href="#cb70-53" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb70-54"><a href="#cb70-54" tabindex="-1"></a></span>
<span id="cb70-55"><a href="#cb70-55" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb70-56"><a href="#cb70-56" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings_sampler</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">sigma =</span> sigma, <span class="at">initial_value =</span> initial_value)</span>
<span id="cb70-57"><a href="#cb70-57" tabindex="-1"></a>  </span>
<span id="cb70-58"><a href="#cb70-58" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">c</span>(chains, <span class="fu">list</span>(samples))</span>
<span id="cb70-59"><a href="#cb70-59" tabindex="-1"></a>  </span>
<span id="cb70-60"><a href="#cb70-60" tabindex="-1"></a>  <span class="co"># Gelman-Rubin</span></span>
<span id="cb70-61"><a href="#cb70-61" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chains)</span>
<span id="cb70-62"><a href="#cb70-62" tabindex="-1"></a>  </span>
<span id="cb70-63"><a href="#cb70-63" tabindex="-1"></a>  <span class="co"># Check that convergence conditions are met</span></span>
<span id="cb70-64"><a href="#cb70-64" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(R_hat) <span class="sc">&amp;&amp;</span> R_hat <span class="sc">&lt;</span> target_R_hat) {</span>
<span id="cb70-65"><a href="#cb70-65" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb70-66"><a href="#cb70-66" tabindex="-1"></a>  }</span>
<span id="cb70-67"><a href="#cb70-67" tabindex="-1"></a>  </span>
<span id="cb70-68"><a href="#cb70-68" tabindex="-1"></a>  <span class="co"># Update initial sample values</span></span>
<span id="cb70-69"><a href="#cb70-69" tabindex="-1"></a>  initial_value <span class="ot">&lt;-</span> samples[<span class="fu">length</span>(samples)]</span>
<span id="cb70-70"><a href="#cb70-70" tabindex="-1"></a>}</span>
<span id="cb70-71"><a href="#cb70-71" tabindex="-1"></a></span>
<span id="cb70-72"><a href="#cb70-72" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Final R_hat:&quot;</span>, R_hat))</span></code></pre></div>
<pre><code>## [1] &quot;Final R_hat: 1.00096183061748&quot;</code></pre>
</div>
<div id="hw08" class="section level2">
<h2>HW08</h2>
<div id="ex-1-4" class="section level3">
<h3>Ex 1</h3>
<ol style="list-style-type: decimal">
<li>The likelihood function for the observed data is <span class="math display">\[
L(\lambda) = \prod_{i=1}^{n} P_\lambda(u_i \leq X_i \leq v_i)
\]</span> For each <span class="math inline">\(X_i\)</span>, we have the
following conditional probabilities: <span class="math display">\[
P_\lambda(u_i \leq X_i \leq v_i) = P_\lambda(X_i \geq u_i) -
P_\lambda(X_i \geq v_i) = e^{-\lambda u_i} - e^{-\lambda v_i}
\]</span> The likelihood function for the observed data is <span class="math display">\[
L(\lambda) = \prod_{i=1}^{n} P_\lambda(u_i \leq X_i \leq
v_i)=\prod_{i=1}^{n} (e^{-\lambda u_i} - e^{-\lambda v_i})
\]</span> Take the logarithm of the likelihood function:</li>
</ol>
<p><span class="math display">\[
\log L(\lambda) = \sum_{i=1}^{n} \log(e^{-\lambda u_i} - e^{-\lambda
v_i})
\]</span> 1. Likelihood function for maximised observations</p>
<p>To solve for the MLE of <span class="math inline">\(\lambda\)</span>,
we need to maximise the likelihood function for the observed data.
Taking logarithms and solving for <span class="math inline">\(\lambda\)</span>, we can obtain the likelihood
equation: <span class="math display">\[
\frac{\partial \log L(\lambda)}{\partial \lambda} = \sum_{i=1}^{n}
\left( \frac{v_i e^{-\lambda v_i} - u_i e^{-\lambda u_i}}{-e^{-\lambda
u_i} + e^{-\lambda v_i}} \right) = 0
\]</span> 2. Using the EM algorithm The log-likelihood function for the
observed data is <span class="math display">\[
\log L(\lambda) = \sum_{i=1}^{n} \log(e^{-\lambda u_i} - e^{-\lambda
v_i})
\]</span> The log-likelihood function for complete data is：</p>
<p><span class="math display">\[
\log L(\lambda) = \sum_{i=1}^{n} \log P(X_i, Z_i | \lambda)
\]</span></p>
<p>where <span class="math inline">\(X_i\)</span> denotes the observed
data;</p>
<p><span class="math inline">\(Z_i\)</span> denotes the corresponding
implicit variable indicating whether <span class="math inline">\(X_i\)</span> falls in the given interval <span class="math inline">\((u_i,v_i)\)</span> (if <span class="math inline">\(X_i\)</span> falls in the interval, <span class="math inline">\(Z_i = 1\)</span>; otherwise, <span class="math inline">\(Z_i = 0\)</span>);</p>
<p><span class="math inline">\(\lambda\)</span> denotes the parameters
of the model。</p>
<p>E step（Expectation Step）：</p>
<p>Calculate the expectation <span class="math inline">\(\hat{Z}_i\)</span> of the hidden variable <span class="math inline">\(Z_i\)</span>, for the <span class="math inline">\(i\)</span>th observation <span class="math inline">\(X_i\)</span>, with： <span class="math display">\[
\hat{Z}_i = P(Z_i = 1 | X_i, \lambda^{(t)}) = \frac{P(u_i &lt; X_i &lt;
v_i | \lambda^{(t)})}{P(X_i &gt; u_i | \lambda^{(t)}) - P(X_i &gt; v_i |
\lambda^{(t)})}
\]</span> where <span class="math inline">\(\lambda^{(t)}\)</span>
denotes the <span class="math inline">\(\lambda\)</span> value of the
current iteration。</p>
<p>M step（Maximization Step）：</p>
<p>Update the parameter <span class="math inline">\(\lambda\)</span>
using the observed data and the expectations of the hidden variables.
Specifically, maximise the log-likelihood function for the complete
data： <span class="math display">\[
\lambda^{(t+1)} = \arg\max_\lambda \sum_{i=1}^{n} \left( \hat{Z}_i \log
f(X_i;\lambda) \right)
\]</span> where <span class="math inline">\(f(x;\lambda)\)</span> is the
probability density function of the exponential distribution</p>
<p>Repeat steps E and M until <span class="math inline">\(\lambda\)</span> converges, stop iteration</p>
<ol start="3" style="list-style-type: decimal">
<li>prove that It is shown that the EM algorithm converges to the MLE of
the observed data and has linear speed: For the EM algorithm to
converge, the following two conditions need to be satisfied:
<ol style="list-style-type: decimal">
<li>the expectation of the log-likelihood function for complete data
(corresponding to the E-step) is a convex function.</li>
<li>In step M, we can find the parameter values that maximise the
expectation of the log-likelihood function for complete data. The
log-likelihood function for complete data can be expressed as： <span class="math display">\[
\log L_c(\lambda) = \sum_{i=1}^{n} \log f(X_i;\lambda) = \sum_{i=1}^{n}
\left( \hat{Z}_i \log f(X_i;\lambda) \right)
\]</span> where <span class="math inline">\(\hat{Z}_i\)</span> is the
expectation of the hidden variable <span class="math inline">\(Z_i\)</span> computed in the E-step.</li>
</ol></li>
</ol>
<p>Using Jensen’s inequality, we know that for convex functions, there
are <span class="math display">\[\mathbb{E}[g(X)] \geq
g(\mathbb{E}[X])\]</span> Since the function <span class="math inline">\(g(x) = \log x\)</span> is convex, we have
that：</p>
<p><span class="math display">\[
\sum_{i=1}^{n} \left( \hat{Z}i \log f(X_i;\lambda) \right) \geq \log
\left( \sum{i=1}^{n} \left( \hat{Z}_i f(X_i;\lambda) \right) \right)
\]</span> The value of the log-likelihood function for complete data
monotonically increases in each iteration. Since the log-likelihood
function for complete data is upper bounded, the EM algorithm
converges.</p>
<p>In addition, each iteration increases the value of the log-likelihood
function for the complete data, so the EM algorithm has a linear rate of
convergence.</p>
<p>In summary, the EM algorithm converges to MLE and has a linear
convergence rate.</p>
<p>(2)if <span class="math inline">\((u_i, v_i),
i=1,...,n(n=10)\)</span> are obversed as (11, 12), (8, 9), (27, 28),
(13, 14), (16, 17), (0, 1), (23, 24), (10, 11), (24, 25), (2, 3)Try to
implement the above two algorithms separately to get the numerical
solution of the MLE of <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>,</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>                 <span class="dv">8</span>, <span class="dv">9</span>,</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>                 <span class="dv">27</span>, <span class="dv">28</span>,</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>                 <span class="dv">13</span>, <span class="dv">14</span>,</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>                 <span class="dv">16</span>, <span class="dv">17</span>,</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>                 <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>                 <span class="dv">23</span>, <span class="dv">24</span>,</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>                 <span class="dv">10</span>, <span class="dv">11</span>,</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>                 <span class="dv">24</span>, <span class="dv">25</span>,</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>                 <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>  u <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>  v <span class="ot">&lt;-</span> data[, <span class="dv">2</span>]</span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>  </span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>  </span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>  log_likelihood <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> v)))</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a>  </span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>log_likelihood) <span class="co"># Minimisation using negative log-likelihood function with optim function</span></span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a>}</span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="dv">1</span>, <span class="at">fn =</span> MLE, <span class="at">method =</span> <span class="st">&quot;Brent&quot;</span>, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">10</span>)</span>
<span id="cb72-23"><a href="#cb72-23" tabindex="-1"></a></span>
<span id="cb72-24"><a href="#cb72-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;直接极大似然估计结果：&quot;</span>, a1<span class="sc">$</span>par, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 直接极大似然估计结果： 0.0719735</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>EM <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">max_iter =</span> <span class="dv">10000</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  </span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>    lambda_prev <span class="ot">&lt;-</span> lambda</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>    </span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>    <span class="co"># E</span></span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>    z <span class="ot">&lt;-</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">2</span>])) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> data[, <span class="dv">2</span>]))</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>    </span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>    <span class="co"># M</span></span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>      <span class="fu">sum</span>(z <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">/</span> x) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> z) <span class="sc">*</span> <span class="fu">log</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">*</span> data[, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">*</span> data[, <span class="dv">1</span>])))</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>    }, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">maximum =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>minimum</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>    </span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda <span class="sc">-</span> lambda_prev) <span class="sc">&lt;</span> tol) {</span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a>    }</span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a>  }</span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a>  </span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a>}</span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a></span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a></span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">EM</span>(data)</span>
<span id="cb74-26"><a href="#cb74-26" tabindex="-1"></a></span>
<span id="cb74-27"><a href="#cb74-27" tabindex="-1"></a></span>
<span id="cb74-28"><a href="#cb74-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM算法估计结果：&quot;</span>, a2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## EM算法估计结果： 9.999944</code></pre>
</div>
<div id="ex-2-2" class="section level3">
<h3>Ex 2</h3>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoﬀ matrix, or a
positive constant is multiplied times every entry of the payoﬀ matrix.
However, the simplex algorithm may terminate at a diﬀerent basic
feasible point (also optimal). Compute B &lt;- A + 2, ﬁnd the solution
of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also ﬁnd the value of game A and
game B.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="co"># Create payment matrix A</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>               <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>               <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A){</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>  <span class="co"># Solving a zero-sum game with two players using the simplex method</span></span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>  <span class="co"># Optimise player 1 first, optimise player 2 later</span></span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>  </span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>   </span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>  min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co"># v &gt;= 0</span></span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>  max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>  </span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb76-26"><a href="#cb76-26" tabindex="-1"></a>  it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb76-27"><a href="#cb76-27" tabindex="-1"></a>  </span>
<span id="cb76-28"><a href="#cb76-28" tabindex="-1"></a>  <span class="co"># Player 1 optimisation</span></span>
<span id="cb76-29"><a href="#cb76-29" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>)  </span>
<span id="cb76-30"><a href="#cb76-30" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) </span>
<span id="cb76-31"><a href="#cb76-31" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n) </span>
<span id="cb76-32"><a href="#cb76-32" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) </span>
<span id="cb76-33"><a href="#cb76-33" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-34"><a href="#cb76-34" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3, <span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb76-35"><a href="#cb76-35" tabindex="-1"></a>  </span>
<span id="cb76-36"><a href="#cb76-36" tabindex="-1"></a>  <span class="co"># Player 2 optimisation</span></span>
<span id="cb76-37"><a href="#cb76-37" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)  </span>
<span id="cb76-38"><a href="#cb76-38" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))  </span>
<span id="cb76-39"><a href="#cb76-39" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)  </span>
<span id="cb76-40"><a href="#cb76-40" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>)))  </span>
<span id="cb76-41"><a href="#cb76-41" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-42"><a href="#cb76-42" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3, <span class="at">maxi =</span> <span class="cn">FALSE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb76-43"><a href="#cb76-43" tabindex="-1"></a>  </span>
<span id="cb76-44"><a href="#cb76-44" tabindex="-1"></a>  <span class="co"># 构造结果</span></span>
<span id="cb76-45"><a href="#cb76-45" tabindex="-1"></a>  soln <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb76-46"><a href="#cb76-46" tabindex="-1"></a>    <span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,  <span class="co"># 恢复原始范围的支付矩阵A</span></span>
<span id="cb76-47"><a href="#cb76-47" tabindex="-1"></a>    <span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],  <span class="co"># Player 1&#39;s strategy vector x</span></span>
<span id="cb76-48"><a href="#cb76-48" tabindex="-1"></a>    <span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],  <span class="co"># Player 2&#39;s strategy vector x</span></span>
<span id="cb76-49"><a href="#cb76-49" tabindex="-1"></a>    <span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A,  <span class="co"># The value of the game v</span></span>
<span id="cb76-50"><a href="#cb76-50" tabindex="-1"></a>    <span class="st">&quot;optimal_point&quot;</span> <span class="ot">=</span> <span class="fu">cbind</span>(sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m], sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n])  </span>
<span id="cb76-51"><a href="#cb76-51" tabindex="-1"></a>  )</span>
<span id="cb76-52"><a href="#cb76-52" tabindex="-1"></a>  </span>
<span id="cb76-53"><a href="#cb76-53" tabindex="-1"></a>  <span class="fu">return</span>(soln)</span>
<span id="cb76-54"><a href="#cb76-54" tabindex="-1"></a>}</span>
<span id="cb76-55"><a href="#cb76-55" tabindex="-1"></a></span>
<span id="cb76-56"><a href="#cb76-56" tabindex="-1"></a>soln_A <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(A)</span>
<span id="cb76-57"><a href="#cb76-57" tabindex="-1"></a>soln_B <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb76-58"><a href="#cb76-58" tabindex="-1"></a><span class="fu">round</span>(soln_A<span class="sc">$</span>optimal_point, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">round</span>(soln_A<span class="sc">$</span>v, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x10 
##   0</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">round</span>(soln_B<span class="sc">$</span>optimal_point, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">round</span>(soln_B<span class="sc">$</span>v, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
</div>
</div>
<div id="hw09" class="section level2">
<h2>HW09</h2>
<div id="ex4" class="section level3">
<h3>2.1.3 ex4</h3>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="co"># In R, the unlist() function is used to convert lists into atomic vectors by combining all the elements of a list into a single vector, while the as.vector() function is mainly used to force conversions and cannot directly convert lists into atomic vectors.</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a><span class="co">#The main reason for using unlist() instead of as.vector() is that unlist() is specifically designed to flatten a list structure and concatenate its elements into a single vector. It recursively traverses the list and extracts each element, preserving their order. This feature of unlist() is critical when there are nested lists with multiple levels of nesting and you want to collapse them into a single vector.</span></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a><span class="co">#as.vector() is primarily used for forced conversions, where it attempts to convert objects into vectors of the appropriate pattern. It is useful for converting other data types (such as matrices or arrays) to vector form. However, when it comes to lists, as.vector() does not automatically flatten the list structure. It can only force a list to be converted to a vector of type &quot;list&quot;, where each element of the resulting vector is a list.</span></span></code></pre></div>
</div>
<div id="ex1" class="section level3">
<h3>2.3.1 ex1</h3>
<p>What does dim() return when applied to a vector?</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co">#dim() function is used to retrieve or set the dimension of an object, such as a matrix or array. When applied to a vector, the dim() function returns NULL.</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a><span class="co"># In R, a vector is considered a one-dimensional object that represents a sequence of elements with the same data type. Since vectors do not have multiple dimensions like matrices or arrays, the dim() function does not have any meaningful dimensions to return.</span></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
<div id="ex2" class="section level3">
<h3>2.3.1 ex2</h3>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co"># Again, TRUE, the array is a multidimensional matrix.</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="ex2-1" class="section level3">
<h3>2.4.5 ex2</h3>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co"># Forced type conversion occurs and the resulting matrix will be a character matrix</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">B =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="at">C =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>))</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df)</span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a><span class="fu">print</span>(matrix)</span></code></pre></div>
<pre><code>##      A   B   C      
## [1,] &quot;1&quot; &quot;a&quot; &quot;TRUE&quot; 
## [2,] &quot;2&quot; &quot;b&quot; &quot;FALSE&quot;
## [3,] &quot;3&quot; &quot;c&quot; &quot;TRUE&quot;</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">class</span>(matrix))</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
</div>
<div id="ex3" class="section level3">
<h3>2.4.5 ex3</h3>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co">#yes</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a><span class="co">#The number of rows and columns is 0</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>empty_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>num_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(empty_df)</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>num_cols <span class="ot">&lt;-</span> <span class="fu">ncol</span>(empty_df)</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a><span class="fu">print</span>(num_rows)  </span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">print</span>(num_cols) </span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="co">#rows are 0</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span>, <span class="fu">seq</span>(<span class="dv">10</span>))[<span class="cn">FALSE</span>, ]</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co">#cols are 0</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span>, <span class="fu">seq</span>(<span class="dv">10</span>))[, <span class="cn">FALSE</span>]</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 10  0</code></pre>
</div>
<div id="ex2-p204" class="section level3">
<h3>ex2 P204</h3>
<p>The function below scales a vector so it falls in the range [0,1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="co">#scale01 &lt;- function(x) {</span></span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="co">#  rng &lt;- range(x, na.rm = TRUE)</span></span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a><span class="co">#  (x - rng[1]) / (rng[2] - rng[1])</span></span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a><span class="co">#}</span></span></code></pre></div>
<p>How would you apply it to every column of a data frame?</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>}</span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a><span class="fu">lapply</span>(mtcars, scale01) </span></code></pre></div>
<pre><code>## $mpg
##  [1] 0.4510638 0.4510638 0.5276596 0.4680851 0.3531915 0.3276596 0.1659574
##  [8] 0.5957447 0.5276596 0.3744681 0.3148936 0.2553191 0.2936170 0.2042553
## [15] 0.0000000 0.0000000 0.1829787 0.9361702 0.8510638 1.0000000 0.4723404
## [22] 0.2170213 0.2042553 0.1234043 0.3744681 0.7191489 0.6638298 0.8510638
## [29] 0.2297872 0.3957447 0.1957447 0.4680851
## 
## $cyl
##  [1] 0.5 0.5 0.0 0.5 1.0 0.5 1.0 0.0 0.0 0.5 0.5 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0
## [20] 0.0 0.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 1.0 0.5 1.0 0.0
## 
## $disp
##  [1] 0.22175106 0.22175106 0.09204290 0.46620105 0.72062859 0.38388626
##  [7] 0.72062859 0.18857570 0.17385882 0.24070841 0.24070841 0.51060115
## [13] 0.51060115 0.51060115 1.00000000 0.97006735 0.92017960 0.01895735
## [19] 0.01147418 0.00000000 0.12222499 0.61586431 0.58094288 0.69568471
## [25] 0.82040409 0.01970566 0.12272387 0.05986530 0.69817910 0.18433525
## [31] 0.57345972 0.12446994
## 
## $hp
##  [1] 0.20494700 0.20494700 0.14487633 0.20494700 0.43462898 0.18727915
##  [7] 0.68197880 0.03533569 0.15194346 0.25088339 0.25088339 0.45229682
## [13] 0.45229682 0.45229682 0.54063604 0.57597173 0.62897527 0.04946996
## [19] 0.00000000 0.04593640 0.15901060 0.34628975 0.34628975 0.68197880
## [25] 0.43462898 0.04946996 0.13780919 0.21554770 0.74911661 0.43462898
## [31] 1.00000000 0.20141343
## 
## $drat
##  [1] 0.52534562 0.52534562 0.50230415 0.14746544 0.17972350 0.00000000
##  [7] 0.20737327 0.42857143 0.53456221 0.53456221 0.53456221 0.14285714
## [13] 0.14285714 0.14285714 0.07834101 0.11059908 0.21658986 0.60829493
## [19] 1.00000000 0.67281106 0.43317972 0.00000000 0.17972350 0.44700461
## [25] 0.14746544 0.60829493 0.76958525 0.46543779 0.67281106 0.39631336
## [31] 0.35944700 0.62211982
## 
## $wt
##  [1] 0.28304781 0.34824853 0.20634109 0.43518282 0.49271286 0.49782664
##  [7] 0.52595244 0.42879059 0.41856303 0.49271286 0.49271286 0.65379698
## [13] 0.56686269 0.57964715 0.95551010 1.00000000 0.97980056 0.17565840
## [19] 0.02608029 0.08233188 0.24341601 0.51316799 0.49143442 0.59498849
## [25] 0.59626694 0.10790079 0.16031705 0.00000000 0.42367681 0.32140118
## [31] 0.52595244 0.32395807
## 
## $qsec
##  [1] 0.23333333 0.30000000 0.48928571 0.58809524 0.30000000 0.68095238
##  [7] 0.15952381 0.65476190 1.00000000 0.45238095 0.52380952 0.34523810
## [13] 0.36904762 0.41666667 0.41428571 0.39523810 0.34761905 0.59166667
## [19] 0.47857143 0.64285714 0.65595238 0.28214286 0.33333333 0.10833333
## [25] 0.30357143 0.52380952 0.26190476 0.28571429 0.00000000 0.11904762
## [31] 0.01190476 0.48809524
## 
## $vs
##  [1] 0 0 1 1 0 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 0 0 0 0 1 0 1 0 0 0 1
## 
## $am
##  [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1
## 
## $gear
##  [1] 0.5 0.5 0.5 0.0 0.0 0.0 0.0 0.5 0.5 0.5 0.5 0.0 0.0 0.0 0.0 0.0 0.0 0.5 0.5
## [20] 0.5 0.0 0.0 0.0 0.0 0.0 0.5 1.0 1.0 1.0 1.0 1.0 0.5
## 
## $carb
##  [1] 0.4285714 0.4285714 0.0000000 0.0000000 0.1428571 0.0000000 0.4285714
##  [8] 0.1428571 0.1428571 0.4285714 0.4285714 0.2857143 0.2857143 0.2857143
## [15] 0.4285714 0.4285714 0.4285714 0.0000000 0.1428571 0.0000000 0.0000000
## [22] 0.1428571 0.1428571 0.4285714 0.1428571 0.0000000 0.1428571 0.1428571
## [29] 0.4285714 0.7142857 1.0000000 0.1428571</code></pre>
<p>How would you apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a>}</span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a><span class="co">#As an example, the Iris dataset</span></span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a>iris[<span class="fu">sapply</span>(iris, is.numeric)]<span class="co">#Selection series</span></span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1            5.1         3.5          1.4         0.2
## 2            4.9         3.0          1.4         0.2
## 3            4.7         3.2          1.3         0.2
## 4            4.6         3.1          1.5         0.2
## 5            5.0         3.6          1.4         0.2
## 6            5.4         3.9          1.7         0.4
## 7            4.6         3.4          1.4         0.3
## 8            5.0         3.4          1.5         0.2
## 9            4.4         2.9          1.4         0.2
## 10           4.9         3.1          1.5         0.1
## 11           5.4         3.7          1.5         0.2
## 12           4.8         3.4          1.6         0.2
## 13           4.8         3.0          1.4         0.1
## 14           4.3         3.0          1.1         0.1
## 15           5.8         4.0          1.2         0.2
## 16           5.7         4.4          1.5         0.4
## 17           5.4         3.9          1.3         0.4
## 18           5.1         3.5          1.4         0.3
## 19           5.7         3.8          1.7         0.3
## 20           5.1         3.8          1.5         0.3
## 21           5.4         3.4          1.7         0.2
## 22           5.1         3.7          1.5         0.4
## 23           4.6         3.6          1.0         0.2
## 24           5.1         3.3          1.7         0.5
## 25           4.8         3.4          1.9         0.2
## 26           5.0         3.0          1.6         0.2
## 27           5.0         3.4          1.6         0.4
## 28           5.2         3.5          1.5         0.2
## 29           5.2         3.4          1.4         0.2
## 30           4.7         3.2          1.6         0.2
## 31           4.8         3.1          1.6         0.2
## 32           5.4         3.4          1.5         0.4
## 33           5.2         4.1          1.5         0.1
## 34           5.5         4.2          1.4         0.2
## 35           4.9         3.1          1.5         0.2
## 36           5.0         3.2          1.2         0.2
## 37           5.5         3.5          1.3         0.2
## 38           4.9         3.6          1.4         0.1
## 39           4.4         3.0          1.3         0.2
## 40           5.1         3.4          1.5         0.2
## 41           5.0         3.5          1.3         0.3
## 42           4.5         2.3          1.3         0.3
## 43           4.4         3.2          1.3         0.2
## 44           5.0         3.5          1.6         0.6
## 45           5.1         3.8          1.9         0.4
## 46           4.8         3.0          1.4         0.3
## 47           5.1         3.8          1.6         0.2
## 48           4.6         3.2          1.4         0.2
## 49           5.3         3.7          1.5         0.2
## 50           5.0         3.3          1.4         0.2
## 51           7.0         3.2          4.7         1.4
## 52           6.4         3.2          4.5         1.5
## 53           6.9         3.1          4.9         1.5
## 54           5.5         2.3          4.0         1.3
## 55           6.5         2.8          4.6         1.5
## 56           5.7         2.8          4.5         1.3
## 57           6.3         3.3          4.7         1.6
## 58           4.9         2.4          3.3         1.0
## 59           6.6         2.9          4.6         1.3
## 60           5.2         2.7          3.9         1.4
## 61           5.0         2.0          3.5         1.0
## 62           5.9         3.0          4.2         1.5
## 63           6.0         2.2          4.0         1.0
## 64           6.1         2.9          4.7         1.4
## 65           5.6         2.9          3.6         1.3
## 66           6.7         3.1          4.4         1.4
## 67           5.6         3.0          4.5         1.5
## 68           5.8         2.7          4.1         1.0
## 69           6.2         2.2          4.5         1.5
## 70           5.6         2.5          3.9         1.1
## 71           5.9         3.2          4.8         1.8
## 72           6.1         2.8          4.0         1.3
## 73           6.3         2.5          4.9         1.5
## 74           6.1         2.8          4.7         1.2
## 75           6.4         2.9          4.3         1.3
## 76           6.6         3.0          4.4         1.4
## 77           6.8         2.8          4.8         1.4
## 78           6.7         3.0          5.0         1.7
## 79           6.0         2.9          4.5         1.5
## 80           5.7         2.6          3.5         1.0
## 81           5.5         2.4          3.8         1.1
## 82           5.5         2.4          3.7         1.0
## 83           5.8         2.7          3.9         1.2
## 84           6.0         2.7          5.1         1.6
## 85           5.4         3.0          4.5         1.5
## 86           6.0         3.4          4.5         1.6
## 87           6.7         3.1          4.7         1.5
## 88           6.3         2.3          4.4         1.3
## 89           5.6         3.0          4.1         1.3
## 90           5.5         2.5          4.0         1.3
## 91           5.5         2.6          4.4         1.2
## 92           6.1         3.0          4.6         1.4
## 93           5.8         2.6          4.0         1.2
## 94           5.0         2.3          3.3         1.0
## 95           5.6         2.7          4.2         1.3
## 96           5.7         3.0          4.2         1.2
## 97           5.7         2.9          4.2         1.3
## 98           6.2         2.9          4.3         1.3
## 99           5.1         2.5          3.0         1.1
## 100          5.7         2.8          4.1         1.3
## 101          6.3         3.3          6.0         2.5
## 102          5.8         2.7          5.1         1.9
## 103          7.1         3.0          5.9         2.1
## 104          6.3         2.9          5.6         1.8
## 105          6.5         3.0          5.8         2.2
## 106          7.6         3.0          6.6         2.1
## 107          4.9         2.5          4.5         1.7
## 108          7.3         2.9          6.3         1.8
## 109          6.7         2.5          5.8         1.8
## 110          7.2         3.6          6.1         2.5
## 111          6.5         3.2          5.1         2.0
## 112          6.4         2.7          5.3         1.9
## 113          6.8         3.0          5.5         2.1
## 114          5.7         2.5          5.0         2.0
## 115          5.8         2.8          5.1         2.4
## 116          6.4         3.2          5.3         2.3
## 117          6.5         3.0          5.5         1.8
## 118          7.7         3.8          6.7         2.2
## 119          7.7         2.6          6.9         2.3
## 120          6.0         2.2          5.0         1.5
## 121          6.9         3.2          5.7         2.3
## 122          5.6         2.8          4.9         2.0
## 123          7.7         2.8          6.7         2.0
## 124          6.3         2.7          4.9         1.8
## 125          6.7         3.3          5.7         2.1
## 126          7.2         3.2          6.0         1.8
## 127          6.2         2.8          4.8         1.8
## 128          6.1         3.0          4.9         1.8
## 129          6.4         2.8          5.6         2.1
## 130          7.2         3.0          5.8         1.6
## 131          7.4         2.8          6.1         1.9
## 132          7.9         3.8          6.4         2.0
## 133          6.4         2.8          5.6         2.2
## 134          6.3         2.8          5.1         1.5
## 135          6.1         2.6          5.6         1.4
## 136          7.7         3.0          6.1         2.3
## 137          6.3         3.4          5.6         2.4
## 138          6.4         3.1          5.5         1.8
## 139          6.0         3.0          4.8         1.8
## 140          6.9         3.1          5.4         2.1
## 141          6.7         3.1          5.6         2.4
## 142          6.9         3.1          5.1         2.3
## 143          5.8         2.7          5.1         1.9
## 144          6.8         3.2          5.9         2.3
## 145          6.7         3.3          5.7         2.5
## 146          6.7         3.0          5.2         2.3
## 147          6.3         2.5          5.0         1.9
## 148          6.5         3.0          5.2         2.0
## 149          6.2         3.4          5.4         2.3
## 150          5.9         3.0          5.1         1.8</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">lapply</span>(iris[<span class="fu">sapply</span>(iris, is.numeric)], scale01)</span></code></pre></div>
<pre><code>## $Sepal.Length
##   [1] 0.22222222 0.16666667 0.11111111 0.08333333 0.19444444 0.30555556
##   [7] 0.08333333 0.19444444 0.02777778 0.16666667 0.30555556 0.13888889
##  [13] 0.13888889 0.00000000 0.41666667 0.38888889 0.30555556 0.22222222
##  [19] 0.38888889 0.22222222 0.30555556 0.22222222 0.08333333 0.22222222
##  [25] 0.13888889 0.19444444 0.19444444 0.25000000 0.25000000 0.11111111
##  [31] 0.13888889 0.30555556 0.25000000 0.33333333 0.16666667 0.19444444
##  [37] 0.33333333 0.16666667 0.02777778 0.22222222 0.19444444 0.05555556
##  [43] 0.02777778 0.19444444 0.22222222 0.13888889 0.22222222 0.08333333
##  [49] 0.27777778 0.19444444 0.75000000 0.58333333 0.72222222 0.33333333
##  [55] 0.61111111 0.38888889 0.55555556 0.16666667 0.63888889 0.25000000
##  [61] 0.19444444 0.44444444 0.47222222 0.50000000 0.36111111 0.66666667
##  [67] 0.36111111 0.41666667 0.52777778 0.36111111 0.44444444 0.50000000
##  [73] 0.55555556 0.50000000 0.58333333 0.63888889 0.69444444 0.66666667
##  [79] 0.47222222 0.38888889 0.33333333 0.33333333 0.41666667 0.47222222
##  [85] 0.30555556 0.47222222 0.66666667 0.55555556 0.36111111 0.33333333
##  [91] 0.33333333 0.50000000 0.41666667 0.19444444 0.36111111 0.38888889
##  [97] 0.38888889 0.52777778 0.22222222 0.38888889 0.55555556 0.41666667
## [103] 0.77777778 0.55555556 0.61111111 0.91666667 0.16666667 0.83333333
## [109] 0.66666667 0.80555556 0.61111111 0.58333333 0.69444444 0.38888889
## [115] 0.41666667 0.58333333 0.61111111 0.94444444 0.94444444 0.47222222
## [121] 0.72222222 0.36111111 0.94444444 0.55555556 0.66666667 0.80555556
## [127] 0.52777778 0.50000000 0.58333333 0.80555556 0.86111111 1.00000000
## [133] 0.58333333 0.55555556 0.50000000 0.94444444 0.55555556 0.58333333
## [139] 0.47222222 0.72222222 0.66666667 0.72222222 0.41666667 0.69444444
## [145] 0.66666667 0.66666667 0.55555556 0.61111111 0.52777778 0.44444444
## 
## $Sepal.Width
##   [1] 0.62500000 0.41666667 0.50000000 0.45833333 0.66666667 0.79166667
##   [7] 0.58333333 0.58333333 0.37500000 0.45833333 0.70833333 0.58333333
##  [13] 0.41666667 0.41666667 0.83333333 1.00000000 0.79166667 0.62500000
##  [19] 0.75000000 0.75000000 0.58333333 0.70833333 0.66666667 0.54166667
##  [25] 0.58333333 0.41666667 0.58333333 0.62500000 0.58333333 0.50000000
##  [31] 0.45833333 0.58333333 0.87500000 0.91666667 0.45833333 0.50000000
##  [37] 0.62500000 0.66666667 0.41666667 0.58333333 0.62500000 0.12500000
##  [43] 0.50000000 0.62500000 0.75000000 0.41666667 0.75000000 0.50000000
##  [49] 0.70833333 0.54166667 0.50000000 0.50000000 0.45833333 0.12500000
##  [55] 0.33333333 0.33333333 0.54166667 0.16666667 0.37500000 0.29166667
##  [61] 0.00000000 0.41666667 0.08333333 0.37500000 0.37500000 0.45833333
##  [67] 0.41666667 0.29166667 0.08333333 0.20833333 0.50000000 0.33333333
##  [73] 0.20833333 0.33333333 0.37500000 0.41666667 0.33333333 0.41666667
##  [79] 0.37500000 0.25000000 0.16666667 0.16666667 0.29166667 0.29166667
##  [85] 0.41666667 0.58333333 0.45833333 0.12500000 0.41666667 0.20833333
##  [91] 0.25000000 0.41666667 0.25000000 0.12500000 0.29166667 0.41666667
##  [97] 0.37500000 0.37500000 0.20833333 0.33333333 0.54166667 0.29166667
## [103] 0.41666667 0.37500000 0.41666667 0.41666667 0.20833333 0.37500000
## [109] 0.20833333 0.66666667 0.50000000 0.29166667 0.41666667 0.20833333
## [115] 0.33333333 0.50000000 0.41666667 0.75000000 0.25000000 0.08333333
## [121] 0.50000000 0.33333333 0.33333333 0.29166667 0.54166667 0.50000000
## [127] 0.33333333 0.41666667 0.33333333 0.41666667 0.33333333 0.75000000
## [133] 0.33333333 0.33333333 0.25000000 0.41666667 0.58333333 0.45833333
## [139] 0.41666667 0.45833333 0.45833333 0.45833333 0.29166667 0.50000000
## [145] 0.54166667 0.41666667 0.20833333 0.41666667 0.58333333 0.41666667
## 
## $Petal.Length
##   [1] 0.06779661 0.06779661 0.05084746 0.08474576 0.06779661 0.11864407
##   [7] 0.06779661 0.08474576 0.06779661 0.08474576 0.08474576 0.10169492
##  [13] 0.06779661 0.01694915 0.03389831 0.08474576 0.05084746 0.06779661
##  [19] 0.11864407 0.08474576 0.11864407 0.08474576 0.00000000 0.11864407
##  [25] 0.15254237 0.10169492 0.10169492 0.08474576 0.06779661 0.10169492
##  [31] 0.10169492 0.08474576 0.08474576 0.06779661 0.08474576 0.03389831
##  [37] 0.05084746 0.06779661 0.05084746 0.08474576 0.05084746 0.05084746
##  [43] 0.05084746 0.10169492 0.15254237 0.06779661 0.10169492 0.06779661
##  [49] 0.08474576 0.06779661 0.62711864 0.59322034 0.66101695 0.50847458
##  [55] 0.61016949 0.59322034 0.62711864 0.38983051 0.61016949 0.49152542
##  [61] 0.42372881 0.54237288 0.50847458 0.62711864 0.44067797 0.57627119
##  [67] 0.59322034 0.52542373 0.59322034 0.49152542 0.64406780 0.50847458
##  [73] 0.66101695 0.62711864 0.55932203 0.57627119 0.64406780 0.67796610
##  [79] 0.59322034 0.42372881 0.47457627 0.45762712 0.49152542 0.69491525
##  [85] 0.59322034 0.59322034 0.62711864 0.57627119 0.52542373 0.50847458
##  [91] 0.57627119 0.61016949 0.50847458 0.38983051 0.54237288 0.54237288
##  [97] 0.54237288 0.55932203 0.33898305 0.52542373 0.84745763 0.69491525
## [103] 0.83050847 0.77966102 0.81355932 0.94915254 0.59322034 0.89830508
## [109] 0.81355932 0.86440678 0.69491525 0.72881356 0.76271186 0.67796610
## [115] 0.69491525 0.72881356 0.76271186 0.96610169 1.00000000 0.67796610
## [121] 0.79661017 0.66101695 0.96610169 0.66101695 0.79661017 0.84745763
## [127] 0.64406780 0.66101695 0.77966102 0.81355932 0.86440678 0.91525424
## [133] 0.77966102 0.69491525 0.77966102 0.86440678 0.77966102 0.76271186
## [139] 0.64406780 0.74576271 0.77966102 0.69491525 0.69491525 0.83050847
## [145] 0.79661017 0.71186441 0.67796610 0.71186441 0.74576271 0.69491525
## 
## $Petal.Width
##   [1] 0.04166667 0.04166667 0.04166667 0.04166667 0.04166667 0.12500000
##   [7] 0.08333333 0.04166667 0.04166667 0.00000000 0.04166667 0.04166667
##  [13] 0.00000000 0.00000000 0.04166667 0.12500000 0.12500000 0.08333333
##  [19] 0.08333333 0.08333333 0.04166667 0.12500000 0.04166667 0.16666667
##  [25] 0.04166667 0.04166667 0.12500000 0.04166667 0.04166667 0.04166667
##  [31] 0.04166667 0.12500000 0.00000000 0.04166667 0.04166667 0.04166667
##  [37] 0.04166667 0.00000000 0.04166667 0.04166667 0.08333333 0.08333333
##  [43] 0.04166667 0.20833333 0.12500000 0.08333333 0.04166667 0.04166667
##  [49] 0.04166667 0.04166667 0.54166667 0.58333333 0.58333333 0.50000000
##  [55] 0.58333333 0.50000000 0.62500000 0.37500000 0.50000000 0.54166667
##  [61] 0.37500000 0.58333333 0.37500000 0.54166667 0.50000000 0.54166667
##  [67] 0.58333333 0.37500000 0.58333333 0.41666667 0.70833333 0.50000000
##  [73] 0.58333333 0.45833333 0.50000000 0.54166667 0.54166667 0.66666667
##  [79] 0.58333333 0.37500000 0.41666667 0.37500000 0.45833333 0.62500000
##  [85] 0.58333333 0.62500000 0.58333333 0.50000000 0.50000000 0.50000000
##  [91] 0.45833333 0.54166667 0.45833333 0.37500000 0.50000000 0.45833333
##  [97] 0.50000000 0.50000000 0.41666667 0.50000000 1.00000000 0.75000000
## [103] 0.83333333 0.70833333 0.87500000 0.83333333 0.66666667 0.70833333
## [109] 0.70833333 1.00000000 0.79166667 0.75000000 0.83333333 0.79166667
## [115] 0.95833333 0.91666667 0.70833333 0.87500000 0.91666667 0.58333333
## [121] 0.91666667 0.79166667 0.79166667 0.70833333 0.83333333 0.70833333
## [127] 0.70833333 0.70833333 0.83333333 0.62500000 0.75000000 0.79166667
## [133] 0.87500000 0.58333333 0.54166667 0.91666667 0.95833333 0.70833333
## [139] 0.70833333 0.83333333 0.95833333 0.91666667 0.75000000 0.91666667
## [145] 1.00000000 0.91666667 0.75000000 0.79166667 0.91666667 0.70833333</code></pre>
</div>
<div id="ex1-p213" class="section level3">
<h3>ex1 P213</h3>
<p>Use vapply() to: a) Compute the standard deviation of every column in
a numeric data frame. b) Compute the standard deviation of every numeric
column in a mixed data frame. (Hint: you’ll need to use vapply()
twice.)</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co">#a</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x y
## 1 1 4
## 2 2 4
## 3 3 5</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">vapply</span>(df,sd,<span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##         x         y 
## 1.0000000 0.5773503</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="co">#b</span></span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>df<span class="sc">$</span>z<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x y z
## 1 1 4 A
## 2 2 4 B
## 3 3 5 C</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="fu">vapply</span>(df[<span class="fu">vapply</span>(df,is.numeric,<span class="cn">TRUE</span>)],sd,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>##         x         y 
## 1.0000000 0.5773503</code></pre>
</div>
<div id="section-16" class="section level3">
<h3>9.8</h3>
<p>The source R code are as follows:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="co">#R code:</span></span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N,thin,a,b,n){</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.5</span>,<span class="at">size=</span>n)</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">prob =</span> y, <span class="at">size =</span> n)</span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span> a, n <span class="sc">-</span> x<span class="sc">+</span> b)</span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a>    }</span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb118-12"><a href="#cb118-12" tabindex="-1"></a>  }</span>
<span id="cb118-13"><a href="#cb118-13" tabindex="-1"></a>  mat</span>
<span id="cb118-14"><a href="#cb118-14" tabindex="-1"></a>}</span>
<span id="cb118-15"><a href="#cb118-15" tabindex="-1"></a></span>
<span id="cb118-16"><a href="#cb118-16" tabindex="-1"></a><span class="co">#The C++ code:</span></span>
<span id="cb118-17"><a href="#cb118-17" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb118-18"><a href="#cb118-18" tabindex="-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb118-19"><a href="#cb118-19" tabindex="-1"></a>using namespace Rcpp;</span>
<span id="cb118-20"><a href="#cb118-20" tabindex="-1"></a></span>
<span id="cb118-21"><a href="#cb118-21" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb118-22"><a href="#cb118-22" tabindex="-1"></a>NumericMatrix <span class="fu">GibbsC</span>(int N, int thin, int a, int b,int n) {</span>
<span id="cb118-23"><a href="#cb118-23" tabindex="-1"></a>   NumericMatrix <span class="fu">mat</span>(N, <span class="dv">2</span>);</span>
<span id="cb118-24"><a href="#cb118-24" tabindex="-1"></a>   double x <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,n)[<span class="dv">0</span>]; </span>
<span id="cb118-25"><a href="#cb118-25" tabindex="-1"></a>   double y <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)[<span class="dv">0</span>];</span>
<span id="cb118-26"><a href="#cb118-26" tabindex="-1"></a>   <span class="cf">for</span>(int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> N; i<span class="sc">++</span>) {</span>
<span id="cb118-27"><a href="#cb118-27" tabindex="-1"></a>     <span class="cf">for</span>(int <span class="at">j =</span> <span class="dv">0</span>; j <span class="sc">&lt;</span> thin; j<span class="sc">++</span>) {</span>
<span id="cb118-28"><a href="#cb118-28" tabindex="-1"></a>       x <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,y,n)[<span class="dv">0</span>];</span>
<span id="cb118-29"><a href="#cb118-29" tabindex="-1"></a>       y <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)[<span class="dv">0</span>];</span>
<span id="cb118-30"><a href="#cb118-30" tabindex="-1"></a>     }</span>
<span id="cb118-31"><a href="#cb118-31" tabindex="-1"></a>     <span class="fu">mat</span>(i, <span class="dv">0</span>) <span class="ot">=</span> x;</span>
<span id="cb118-32"><a href="#cb118-32" tabindex="-1"></a>     <span class="fu">mat</span>(i, <span class="dv">1</span>) <span class="ot">=</span> y;</span>
<span id="cb118-33"><a href="#cb118-33" tabindex="-1"></a>   }</span>
<span id="cb118-34"><a href="#cb118-34" tabindex="-1"></a>   <span class="fu">return</span>(mat);</span>
<span id="cb118-35"><a href="#cb118-35" tabindex="-1"></a>}</span>
<span id="cb118-36"><a href="#cb118-36" tabindex="-1"></a></span>
<span id="cb118-37"><a href="#cb118-37" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb118-38"><a href="#cb118-38" tabindex="-1"></a>tm1 <span class="ot">&lt;-</span> microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb118-39"><a href="#cb118-39" tabindex="-1"></a><span class="at">rnR =</span> <span class="fu">GibbsR</span>(<span class="fl">1e3</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>),</span>
<span id="cb118-40"><a href="#cb118-40" tabindex="-1"></a><span class="at">rnC =</span> <span class="fu">GibbsC</span>(<span class="fl">1e3</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb118-41"><a href="#cb118-41" tabindex="-1"></a> )</span>
<span id="cb118-42"><a href="#cb118-42" tabindex="-1"></a> <span class="fu">print</span>(<span class="fu">summary</span>(tm1)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
